import{_ as L}from"./ListView.DgUPeMcI.js";import{l as P,r as g,o as r,c as n,a as t,t as e,j as l,F as f,b as _,n as E,q as N,s as T,B as S,h as O,w as x,u as w,v as C}from"./entry.R6V7NTxy.js";import{_ as H}from"./LayoutPrint.Dr_MMYe1.js";import{_ as j}from"./ApprovalDenyButton.B1ShEyLo.js";import{_ as B}from"./PsModal.DW9SixU3.js";import{a as $}from"./Accessibilities.uaboihcy.js";import{b as y,c as h}from"./CustomFetch.BRBLzGci.js";const F=P("personelActionNotice",{state:()=>({createData:{isLoading:!1,errorMessage:"",successMessage:"",params:{}},personelActionNotice:{id:null,type:"",date_of_effictivity:"",pan_job_applicant_id:null,employee_id:null,company_id_num:null,section_department_id:null,projects:[],designation_position:null,hire_source:null,work_location:null,employment_status:null,salary_grades:null,salary_type:null,type_of_termination:"",reasons_for_termination:"",eligible_for_rehire:"",last_day_worked:"",approvals:[],deleted_at:"",created_at:"",updated_at:"",created_by:""},errorMessage:"",remarks:"",successMessage:"",errorHandler:[],allPagination:{},myRequestPagination:{},getParams:{employee:""},getParamsMyList:{},allRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},fetchData:{data:g(),status:g(),error:g(),refresh:g()}},myApprovals:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},myRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}}}),actions:{async savePan(){if(this.createData.isLoading)return;this.successMessage="",this.errorMessage="";const s=JSON.parse(JSON.stringify(this.personelActionNotice));s.approvals=JSON.stringify(s.approvals),await y("/api/pan/resource",{method:"POST",body:s,onRequest:()=>{this.createData.isLoading=!0},onResponseError:({response:a})=>{throw this.createData.isLoading=!1,this.errorMessage=a._data.message,new Error(a._data.message)},onResponse:({response:a})=>{if(this.createData.isLoading=!1,a.ok)return this.reloadResources(),this.successMessage=a._data.message,a._data;throw this.errorMessage=a._data.message,new Error(a._data.message)}})},async generateCompanyIdNum(){await h("/api/pan/generate-company-id-num",{method:"GET",onResponse:({response:s})=>{if(s.ok)this.personelActionNotice.company_id_num=s._data.data??"";else throw new Error(s._data.message)}})},async getOne(s){return await y("/api/pan/resource/"+s,{method:"GET",params:this.getParams,onResponse:({response:a})=>{if(a.ok)return a._data.data;throw new Error(a._data.message)}})},async getAllRequest(){this.successMessage="",this.errorMessage="",this.allRequests.isLoaded=!0;const{data:s,status:a,error:i,refresh:c}=await h("/api/pan/resource",{method:"GET",params:this.allRequests.params,watch:!1,onRequest:()=>{this.allRequests.isLoading=!0},onResponse:({response:o})=>{if(this.allRequests.isLoading=!1,o.ok)this.allRequests.list=o._data.data??[],this.allRequests.pagination={first_page:o._data.links.first,pages:o._data.meta.links,last_page:o._data.links.last};else throw this.errorMessage=o._data.message,new Error(o._data.message)}});this.allRequests.fetchData.data=s,this.allRequests.fetchData.status=a,this.allRequests.fetchData.error=i,this.allRequests.fetchData.refresh=c},async getMyApprovals(){this.successMessage="",this.errorMessage="",this.myApprovals.isLoaded=!0,await h("/api/pan/my-approvals",{method:"GET",params:this.myApprovals.params,watch:!1,onResponse:({response:s})=>{if(s.ok)this.myApprovals.list=s._data.data??[],this.myApprovals.pagination={first_page:s._data.links.first,pages:s._data.meta.links,last_page:s._data.links.last};else throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async getMyRequests(){this.successMessage="",this.errorMessage="",this.myRequests.isLoaded=!0,await h("/api/pan/my-request",{method:"GET",params:this.myRequests.params,watch:!1,onResponse:({response:s})=>{if(s.ok)this.myRequests.list=s._data.data??[],this.myRequests.pagination={first_page:s._data.links.first,pages:s._data.meta.links,last_page:s._data.links.last};else throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async approvedPanRequest(s){this.successMessage="",this.errorMessage="",await y("/api/approvals/approve/EmployeePanRequest/"+s,{method:"POST",onResponse:({response:a})=>{if(a.ok)this.reloadResources(),this.successMessage=a._data.message;else throw this.errorMessage=a._data.message,new Error(a._data.message)}})},async denyRequest(s){this.successMessage="",this.errorMessage="";const a=new FormData;a.append("id",s),a.append("remarks",this.remarks),await y("/api/approvals/disapprove/EmployeePanRequest/"+s,{method:"POST",body:a,onResponse:({response:i})=>{if(i.ok)this.reloadResources(),this.successMessage=i._data.message;else throw this.errorMessage=i._data.message,new Error(i._data.message)}})},reloadResources(){const s=this.personelActionNotice.approvals,a=[];this.allRequests.isLoaded&&a.push(this.getAllRequest),this.myApprovals.isLoaded&&a.push(this.getMyApprovals),this.myRequests.isLoaded&&a.push(this.getMyRequests),this.$reset(),this.personelActionNotice.approvals=s,a.forEach(i=>{i()})}}}),G={class:"bg-white w-full shadow sm:rounded-lg"},I={class:"border-t border-gray-200"},U={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},V=t("dt",{class:"text-sm font-medium text-gray-500"}," Date of Effectivity ",-1),J={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},W={class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},z=t("dt",{class:"text-sm font-medium text-gray-500"}," Type ",-1),K={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Q={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},X=t("dt",{class:"text-sm font-medium text-gray-500"}," Employee/Applicant Full name ",-1),Y={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Z={key:0,class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ss=t("dt",{class:"text-sm font-medium text-gray-500"}," Hire Source ",-1),ts={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},as={key:1,class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},es=t("dt",{class:"text-sm font-medium text-gray-500"}," Employment Status ",-1),os={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},is={key:2,class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},rs=t("dt",{class:"text-sm font-medium text-gray-500"}," Salary Type ",-1),ns={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},ds={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ms=t("dt",{class:"text-sm font-medium text-gray-500"}," Position ",-1),ls={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},cs={class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ps=t("dt",{class:"text-sm font-medium text-gray-500"}," Salary Grade ",-1),gs={key:0,class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},us={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ys=t("dt",{class:"text-sm font-medium text-gray-500"}," Work Location ",-1),hs={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},_s={key:0,class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},fs=t("dt",{class:"text-sm font-medium text-gray-500"}," Department ",-1),xs={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},ws={key:1,class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},vs=t("dt",{class:"text-sm font-medium text-gray-500"}," Project(s) ",-1),Rs={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Ds={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},ks=t("dt",{class:"text-sm font-medium text-gray-500"}," Type of Termination ",-1),Ms={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},qs={class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},bs=t("dt",{class:"text-sm font-medium text-gray-500"}," Reason for Termination ",-1),As={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Ls={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Ps=t("dt",{class:"text-sm font-medium text-gray-500"}," Termination ",-1),Es={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Ns={class:"bg-gray-50 px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Ts=t("dt",{class:"text-sm font-medium text-gray-500"}," Last Day Worked ",-1),Ss={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Os={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Cs=t("dt",{class:"text-sm font-medium text-gray-500"}," Comments ",-1),Hs={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},js={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Bs=t("dt",{class:"text-sm font-medium text-gray-500"}," Requested By ",-1),$s={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Fs={class:"bg-white px-4 py-2 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"},Gs=t("dt",{class:"text-sm font-medium text-gray-500"}," Requested On ",-1),Is={class:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2"},Us={__name:"PersonalActionFormInfo",props:{panData:{type:Object,required:!0}},setup(s){return(a,i)=>{var o,d;const c=L;return r(),n("div",G,[t("div",I,[t("dl",null,[t("div",U,[V,t("dd",J,e(s.panData.date_of_effictivity),1)]),t("div",W,[z,t("dd",K,e(s.panData.type),1)]),t("div",Q,[X,t("dd",Y,e(s.panData.jobapplicant?s.panData.jobapplicant.fullname_first:s.panData.employee.fullname_first),1)]),["New Hire"].includes(s.panData.type)?(r(),n("div",Z,[ss,t("dd",ts,e(s.panData.hire_source),1)])):l("",!0),["New Hire","Promotion"].includes(s.panData.type)?(r(),n("div",as,[es,t("dd",os,e(s.panData.employment_status),1)])):l("",!0),["New Hire","Transfer","Promotion"].includes(s.panData.type)?(r(),n("div",is,[rs,t("dd",ns,e(s.panData.salary_type),1)])):l("",!0),["New Hire","Promotion"].includes(s.panData.type)?(r(),n(f,{key:3},[t("div",ds,[ms,t("dd",ls,e((o=s.panData.position)==null?void 0:o.name),1)]),t("div",cs,[ps,s.panData.salarygrade?(r(),n("dd",gs," SG "+e((d=s.panData.salarygrade)==null?void 0:d.salary_grade_level.salary_grade_level)+" - Step "+e(s.panData.salarygrade.step_name),1)):l("",!0)])],64)):l("",!0),["New Hire","Transfer"].includes(s.panData.type)?(r(),n(f,{key:4},[t("div",us,[ys,t("dd",hs,e(s.panData.work_location),1)]),s.panData.work_location==="Office"?(r(),n("div",_s,[fs,t("dd",xs,e(s.panData.department_name),1)])):(r(),n("div",ws,[vs,t("dd",Rs,e(s.panData.project_names),1)]))],64)):l("",!0),s.panData.type==="Termination"?(r(),n(f,{key:5},[t("div",Ds,[ks,t("dd",Ms,e(s.panData.type_of_termination),1)]),t("div",qs,[bs,t("dd",As,e(s.panData.reasons_for_termination),1)]),t("div",Ls,[Ps,t("dd",Es,e(s.panData.eligible_for_rehire),1)]),t("div",Ns,[Ts,t("dd",Ss,e(s.panData.last_day_worked),1)])],64)):l("",!0),t("div",Os,[Cs,t("dd",Hs,e(s.panData.comments),1)]),t("div",js,[Bs,t("dd",$s,e(s.panData.created_by_user_name),1)]),t("div",Fs,[Gs,t("dd",Is,e(s.panData.created_at_human),1)]),_(c,{approvals:s.panData.approvals},null,8,["approvals"])])])])}}},Vs={class:"p-2"},Js={key:0,class:"flex gap-2 p-2 justify-end"},st={__name:"InfoModal",props:E({data:{type:Object,required:!0}},{showModal:{required:!1,type:Boolean}}),emits:["update:showModal"],setup(s){const a=N(s,"showModal"),i=F(),{remarks:c}=T(i),o=S(),d=g(!1),v=()=>{a.value=!1},R=async p=>{try{d.value=!0,await i.denyRequest(p),o.add({type:"success",text:i.successMessage})}catch(m){o.add({type:"error",text:m||"something went wrong."})}finally{d.value=!1,v()}},D=async p=>{try{d.value=!0,await i.approvedPanRequest(p),o.add({type:"success",text:"Successfully Approved."})}catch(m){o.add({type:"error",text:m||"something went wrong."})}finally{d.value=!1,v()}};return(p,m)=>{const k=Us,M=H,q=j,b=B;return r(),O(b,{"show-modal":a.value,"onUpdate:showModal":m[1]||(m[1]=u=>a.value=u),"is-loading":w(d),title:"Personnel Action Notice for "+s.data.type},{body:x(()=>[t("div",Vs,[_(M,null,{default:x(()=>[_(k,{"pan-data":s.data},null,8,["pan-data"])]),_:1})])]),footer:x(()=>{var u;return[s.data.next_approval&&("useCheckIsCurrentUser"in p?p.useCheckIsCurrentUser:w($))((u=s.data.next_approval)==null?void 0:u.user_id)?(r(),n("div",Js,[_(q,{"deny-remarks":w(c),"onUpdate:denyRemarks":m[0]||(m[0]=A=>C(c)?c.value=A:null),"request-id":s.data.id,onApprove:D,onDeny:R},null,8,["deny-remarks","request-id"])])):l("",!0)]}),_:1},8,["show-modal","is-loading","title"])}}};export{st as _,F as u};
