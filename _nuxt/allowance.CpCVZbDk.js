import{_ as U}from"./CustomPagination.C91H0oe5.js";import{_ as j}from"./LayoutBoards.vue.D_rbqYxd.js";import{ab as $,l as H,O as z,s as B,B as E,r as D,o as h,h as y,w as M,a as t,c as A,F,i as I,u as o,t as u,x as b,A as V,g as G,b as v,G as N,y as O}from"./entry.32UGFqj-.js";import{h as d}from"./CustomFetch.ggXvTdIz.js";import{_ as Q}from"./AcessContainer.Dum7aOuo.js";import{u as X}from"./vue.f36acd1f.Ds2AlAv6.js";import{u as q,A as J}from"./Accessibilities.xGffDRXj.js";import"./Icon.CrHlyQOo.js";import"./index.T-zbMaZc.js";import"./loader.BQ9QddgL.js";import"./users.G4iuGzk0.js";const{token:p}=$(),m=z(),x=H("Allowances",{state:()=>({isEdit:!1,allowance:{id:null,position_id:"",amount:null},positionList:[],list:[],pagination:{},getParams:{},errorMessage:"",successMessage:""}),getters:{positionAllowances(a){return a.positionList.map(e=>{var s,i,n;return{name:e.name,id:((s=e.allowances)==null?void 0:s.id)||null,position_id:e.id,amount:((i=e.allowances)==null?void 0:i.amount)||0,dpt_name:(n=e.departments)==null?void 0:n.department_name,position_type:e.position_type}})}},actions:{async getPositionAllowances(){const{data:a,error:e}=await d("/api/allowance-list",{baseURL:m.public.HRMS_API_URL,method:"GET",headers:{Authorization:p.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:s})=>{this.positionList=s._data.data}},"$b24LccttPQ");if(a)return a;if(e)return e},async createAllowance(){this.successMessage="",this.errorMessage="",await d("/api/allowance",{baseURL:m.public.HRMS_API_URL,method:"POST",headers:{Authorization:p.value+"",Accept:"application/json"},body:this.allowance,watch:!1,onResponse:({response:a})=>{a.ok?(this.getPositionAllowances(),this.reset(),this.successMessage=a._data.message):this.errorMessage=a._data.message}},"$B06jtnTzDv")},clearMessages(){this.errorMessage="",this.successMessage=""},async editAllowance(){this.successMessage="",this.errorMessage="";const{data:a,error:e}=await d("/api/allowance/"+this.allowance.id,{baseURL:m.public.HRMS_API_URL,method:"PATCH",headers:{Authorization:p.value+"",Accept:"application/json"},body:this.allowance,watch:!1,onResponse:({response:s})=>{this.successMessage=s._data.message}},"$XGUxLQU0FX");if(a.value)return this.getPositionAllowances(),this.reset(),this.successMessage=a.value.message,a;if(e.value)return this.errorMessage=e.value.data.message,e},async deleteAllowance(a){const{data:e,error:s}=await d("/api/allowance/"+a,{baseURL:m.public.HRMS_API_URL,method:"DELETE",headers:{Authorization:p.value+"",Accept:"application/json"},watch:!1,onResponse:({response:i})=>{this.successMessage=i._data.message}},"$Jgy8zHS2gk");if(e.value)return this.getPositionAllowances(),this.successMessage=e.value.message,e;if(s.value)return this.errorMessage=s.value.data.message,s},reset(){this.allowance={id:null,position_id:"",amount:null},this.isEdit=!1,this.successMessage="",this.errorMessage=""}}}),K={class:"pb-2 text-gray-500"},W={class:"table-auto w-full border-collapse"},Y=t("thead",null,[t("tr",{class:"flex justify-between"},[t("th",{class:"p-2"}," Position "),t("th",{class:"p-2"}," Allowance Amount ")])],-1),Z={class:"p-2 items-center flex justify-around"},ee={class:"flex gap-4 p-2 rounded-md"},se=["onUpdate:modelValue"],ae=["onClick"],te={class:"flex justify-center mx-auto"},oe={__name:"AllowanceTable",setup(a){const e=x(),{allowance:s,getParams:i,pagination:n,errorMessage:r,successMessage:w,positionAllowances:P}=B(e),_=E(),g=D(!1),L=c=>{i.value.page=c.page??""},R=async c=>{try{g.value=!0,s.value=c,c.id?await e.editAllowance():await e.createAllowance(),e.errorMessage?_.add({type:"error",text:e.errorMessage}):_.add({type:"success",text:e.successMessage})}catch{_.add({type:"error",text:"An error occurred while processing the allowance."})}finally{e.clearMessages(),g.value=!1}};return(c,k)=>{const C=U,S=j;return h(),y(S,{title:"Allowance List",class:"w-full",loading:o(g)},{default:M(()=>[t("div",K,[t("table",W,[Y,t("tbody",null,[(h(!0),A(F,null,I(o(P),(l,T)=>(h(),A("tr",{key:T,class:"border flex justify-between"},[t("td",Z,u(l.dpt_name+" - "+l.position_type)+"("+u(l.name)+") ",1),t("td",ee,[b(t("input",{"onUpdate:modelValue":f=>l.amount=f,class:"rounded-md",type:"number",step:".01",min:"0",required:""},null,8,se),[[V,l.amount]]),t("button",{type:"submit",class:"rounded-md bg-green-400 p-2 text-white hover:bg-green-500",onClick:G(f=>R(l),["prevent"])}," Save Changes ",8,ae)])]))),128))])])]),t("div",te,[v(C,{links:o(n),onChangeParams:L},null,8,["links"])]),t("p",{hidden:"",class:N(["text-red-600 text-center font-semibold mt-2 italic",{"fade-out":!o(r)}])},u(o(r)),3),b(t("p",{hidden:"",class:"text-green-600 text-center font-semibold italic"},u(o(w)),513),[[O,o(w)]])]),_:1},8,["loading"])}}},ie={class:"flex flex-col md:flex-row gap-4"},we={__name:"allowance",setup(a){return x().getPositionAllowances(),X({title:"Allowance"}),(s,i)=>{const n=oe,r=Q;return h(),y(r,{"if-access":("useCheckAccessibility"in s?s.useCheckAccessibility:o(q))([("AccessibilityTypes"in s?s.AccessibilityTypes:o(J)).hrms_setup_allowance])},{default:M(()=>[t("div",ie,[v(n)])]),_:1},8,["if-access"])}}};export{we as default};
