import{e,i}from"./CustomFetch.BRBLzGci.js";import{l as o}from"./entry.R6V7NTxy.js";const l="Request BOM",m=o("BOMStore",{state:()=>({isEdit:!1,bomRequest:{isLoading:!1,isLoaded:!1,list:[],bomDetails:{isLoading:!1,isLoaded:!1,list:[],params:{}},details:[],formDepartment:{},formProject:{},params:{},pagination:{}},currentBom:{isLoading:!1,isLoaded:!1,list:[],params:{project_id:null,department_id:null},pagination:{}},allRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},myApprovals:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},myRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},approvalList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},errorMessage:"",successMessage:"",remarks:""}),actions:{getConversionBaseValue(a){return a},async getAllRequests(){await e("/api/bom/all-request",{method:"GET",params:this.allRequests.params,onRequest:()=>{this.allRequests.isLoading=!0},onResponse:({response:a})=>{this.allRequests.isLoading=!1,a.ok&&(this.allRequests.isLoaded=!0,this.allRequests.list=a._data.data.data,this.allRequests.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last})}})},async getMyRequests(){await e("/api/bom/my-request",{method:"GET",params:this.myRequests.params,onRequest:()=>{this.myRequests.isLoading=!0},onResponse:({response:a})=>{if(this.myRequests.isLoading=!1,a.ok)this.myRequests.isLoaded=!0,this.myRequests.list=a._data.data.data,this.myRequests.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last};else throw new Error(a._data.message)}})},async getMyApprovals(){await e("/api/bom/my-approvals",{method:"GET",params:this.myApprovals.params,onRequest:()=>{this.myApprovals.isLoading=!0},onResponse:({response:a})=>{if(this.myApprovals.isLoading=!1,a.ok)this.myApprovals.isLoaded=!0,this.myApprovals.list=a._data.data.data,this.myApprovals.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last};else throw new Error(a._data.message)}})},async storeBOMDepartment(){await i("/api/bom/resource",{method:"POST",body:this.bomRequest.formDepartment,watch:!1,onResponse:({response:a})=>{if(a.ok)this.reloadResources(),this.successMessage=a._data.message;else throw this.errorMessage=a._data.message,new Error(a._data.message)}})},async getOne(a){return await i("/api/bom/resource/"+a,{method:"GET",params:this.bomRequest.bomDetails.params,onResponse:({response:s})=>{if(s.ok)return this.bomRequest.bomDetails.list=s._data.data,s._data.data;throw new Error(s._data.message)}})},async getCurrentBOM(){await e("/api/bom/current",{method:"GET",params:this.currentBom.params,watch:!1,onRequest:()=>{this.currentBom.isLoading=!0},onResponse:({response:a})=>{if(this.currentBom.isLoading=!1,a.ok)this.currentBom.isLoaded=!0,this.currentBom.list=a._data.data.details,this.currentBom.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last};else throw new Error(a._data.message)}})},async getMyApprovalRequests(){await e("/api/bom/my-approvals",{method:"GET",onResponse:({response:a})=>{if(a.ok)this.myApprovals.list=a._data.data;else throw this.errorMessage=a._data.message,new Error(a._data.message)}})},async approveApprovalForm(a){this.successMessage="",this.errorMessage="",await e("/api/approvals/approve/RequestBOM/"+a,{method:"POST",onResponseError:({response:s})=>{throw this.errorMessage=s._data.message,new Error(s._data.message)},onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data}})},async denyApprovalForm(a){this.successMessage="",this.errorMessage="";const s=new FormData;s.append("id",a),s.append("remarks",this.remarks),await e("/api/approvals/disapprove/RequestBOM/"+a,{method:"POST",body:s,onResponseError:({response:t})=>{throw this.errorMessage=t._data.message,new Error(t._data.message)},onResponse:({response:t})=>{if(t.ok)return this.successMessage=t._data.message,t._data}})},reloadResources(){const a=this.bomRequest.formDepartment.approvals,s=[];this.allRequests.isLoaded&&s.push(this.getAllRequests),this.myRequests.isLoaded&&s.push(this.getMyRequests),this.myApprovals.isLoaded&&s.push(this.getMyApprovals),this.$reset(),this.bomRequest.formDepartment.approvals=a,s.forEach(t=>{t()})}}});export{l as A,m as u};
