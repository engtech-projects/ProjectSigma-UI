import I from"./Icon.DcF_NU9d.js";import{f as U,r as u,C as Z,L as S,K as j,N as B,o,c as r,a,t as g,u as t,h as C,j as f,x as D,D as E,v as N,F,i as G,A,b as Y,G as L,O as $}from"./entry.R6V7NTxy.js";import{u as q}from"./Utilities.Cbr1Z9cn.js";import{u as H}from"./index.Cobg6QK2.js";const P={class:"text-md flex-1 cursor-pointer select-none max-h-[2.4rem] overflow-hidden text-ellipsis whitespace-nowrap"},Q={key:0,class:"absolute left-0 top-[37px] min-w-[100%] min-h-72 bg-white rounded-md border border-gray-500"},W={class:"flex gap-1 w-full bg-gray-100 p-2 border-b"},z={class:"flex flex-col w-[35%]"},J=a("label",{class:"text-[9px] uppercase text-gray-700 mb-1"},"Dept",-1),K=["value"],X={class:"flex flex-1 items-center gap-1"},ee={class:"flex flex-col pb-2 w-full"},te=a("label",{class:"text-[9px] uppercase text-gray-700 mb-1 cursor-pointer select-none"},"Stakeholder",-1),se={class:"flex items-center gap-1 border border-gray-500 rounded-md"},le=["placeholder"],oe={class:"flex flex-col max-h-[200px] overflow-auto items-center"},ae={key:0,src:"https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExZGJ6eHh2dmZsMHN5ZnI0YTU5MGFocTk4djhxOXBvend4bG1jeCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/sSgvbe1m3n93G/giphy.gif",alt:"",srcset:"",class:"w-5 h-5"},re={key:1,class:"text-xs text-gray-500 p-2"},ne={class:"flex flex-col items-start w-full"},de=["onClick"],he=U({__name:"StakeholderSelect",props:{stakeholderId:{type:Number,required:!0},stakeholder:{type:Object,required:!0},selectOptions:{type:Array,required:!0},placeholder:{type:String,default:"Search Stakeholder"},defaultDept:{type:String,default:null}},emits:["select"],setup(h,{emit:M}){const p=h,O=$(),m=u(!1),x=u(null),c=u(!1),n=u(null),d=u(""),k=async()=>{var e;m.value=!0;try{const s=await $fetch(O.public.ACCOUNTING_API_URL+"/api/search-stakeholders",{method:"GET",watch:!0,params:{type:n.value,key:d.value}});m.value=!1,v.value=((e=s.data)==null?void 0:e.data)??[]}catch{}},b=Z(()=>{var e,s;if(p.stakeholder){const i=(s=(e=p.stakeholder)==null?void 0:e.stakeholdable_type)==null?void 0:s.split("\\");return i?i[i.length-1].toLowerCase():""}return""}),v=u([]),R=H(async()=>{await k()},500);S(d,e=>{if(!e){v.value=[];return}R()}),S(n,async e=>{e&&d.value&&await k()});const y=u(null),T=()=>{c.value=!c.value},_=e=>{y.value&&!y.value.contains(e.target)&&(c.value=!1,n.value=b.value)},V=e=>{x.value=e,M("select",e),c.value=!1};return j(()=>{p.stakeholder&&(x.value=p.stakeholder,n.value=b.value),p.defaultDept&&(n.value=p.defaultDept),document.addEventListener("click",_)}),B(()=>{document.removeEventListener("click",_)}),(e,s)=>{var w;const i=I;return o(),r("div",{ref_key:"dropdownRef",ref:y,class:"relative w-full flex flex-col border border-gray-500 rounded-lg min-h-[2.4rem]"},[a("div",{class:"flex px-2 items-center flex-1 cursor-pointer",onClick:T},[a("span",P,g(((w=t(x))==null?void 0:w.name)||h.placeholder),1),t(c)?f("",!0):(o(),C(i,{key:0,name:"mdi:chevron-down",class:""})),t(c)?(o(),C(i,{key:1,name:"mdi:chevron-up",class:""})):f("",!0)]),t(c)?(o(),r("div",Q,[a("div",W,[a("div",z,[J,D(a("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>N(n)?n.value=l:null),class:"border border-gray-500 rounded-md p-1 text-xs"},[(o(!0),r(F,null,G(h.selectOptions,l=>(o(),r("option",{key:l,value:l},g(("upperFirst"in e?e.upperFirst:t(q))(l)),9,K))),128))],512),[[E,t(n)]])]),a("div",X,[a("div",ee,[te,a("div",se,[t(n)?D((o(),r("input",{key:0,"onUpdate:modelValue":s[1]||(s[1]=l=>N(d)?d.value=l:null),type:"text",class:"border-none rounded-md p-1 text-xs focus:ring-0 flex-1",placeholder:h.placeholder,index:"1"},null,8,le)),[[A,t(d)]]):(o(),r("input",{key:1,disabled:"",type:"text",class:"border-none rounded-md p-1 text-xs flex-1",placeholder:"Search Stakeholder",index:"2",onFocus:s[2]||(s[2]=l=>c.value=!0)},null,32)),Y(i,{name:"mdi:close",class:L(["h-5 w-5 font-bold cursor-pointer text-red-500",{"text-red-700":t(d),"text-white":!t(d)}]),onClick:s[3]||(s[3]=l=>d.value="")},null,8,["class"])])])])]),a("div",oe,[t(m)?(o(),r("img",ae)):f("",!0),t(v).length===0&&!t(m)?(o(),r("span",re,"No result found")):f("",!0),a("div",ne,[(o(!0),r(F,null,G(t(v),l=>(o(),r("span",{key:l,class:L(["text-xs text-gray-700 py-2 px-2 border-b hover:bg-gray-100 cursor-pointer w-full",{"bg-green-200":l.id===t(x).id}]),onClick:ce=>V(l)},g(l.name),11,de))),128))])])])):f("",!0)],512)}}});export{he as _};
