import{e,i as d}from"./CustomFetch.BRBLzGci.js";import{l as o}from"./entry.R6V7NTxy.js";const u="Supplier Accreditation",h=o("SupplierStore",{state:()=>({createRequest:{isLoading:!1,isLoaded:!1,list:[],details:{},form:{},params:{},pagination:{}},attachments:{isLoading:!1,isLoaded:!1,data:{},form:{},params:{},pagination:{}},editRequest:{isLoading:!1,isLoaded:!1,details:{},form:{approvals:[]},params:{},pagination:{}},approvedSuppliers:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},allRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},myApprovals:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},myRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},approvalList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},companyNameList:{isLoading:!1,isLoaded:!1,list:[],params:{}},contactPersonList:{isLoading:!1,isLoaded:!1,list:[],params:{}},supplierCodeList:{isLoading:!1,isLoaded:!1,list:[],params:{}},errorMessage:"",successMessage:"",remarks:""}),actions:{async getAllRequests(){await e("/api/request-supplier/all-request",{method:"GET",params:this.allRequests.params,onRequest:()=>{this.allRequests.isLoading=!0},onResponse:({response:a})=>{this.allRequests.isLoading=!1,a.ok&&(this.allRequests.list=a._data.data.data,this.allRequests.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last},this.allRequests.isLoaded=!0)}})},async fetchSelector(a,s){a.isLoading=!0;const{data:t,error:r}=await e(s,{method:"GET",params:a.params,watch:!1,onResponse:({response:i})=>{a.isLoading=!1,a.successMessage=i._data.message,i._data.success&&(a.successMessage=i._data.message,a.list=i._data.data),i._data.success||(a.errorMessage=i._data.message)}});if(t)return t;if(r)return r},async getMyRequests(){await e("/api/request-supplier/my-request",{method:"GET",params:this.myRequests.params,onRequest:()=>{this.myRequests.isLoading=!0},onResponse:({response:a})=>{if(this.myRequests.isLoading=!1,a.ok)this.myRequests.isLoaded=!0,this.myRequests.list=a._data.data.data,this.myRequests.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last};else throw new Error(a._data.message)}})},async getMyApprovals(){await e("/api/request-supplier/my-approvals",{method:"GET",params:this.myApprovals.params,onRequest:()=>{this.myApprovals.isLoading=!0},onResponse:({response:a})=>{if(this.myApprovals.isLoading=!1,a.ok)this.myApprovals.isLoaded=!0,this.myApprovals.list=a._data.data.data,this.myApprovals.pagination={first_page:a._data.data.links.first,pages:a._data.data.meta.links,last_page:a._data.data.links.last};else throw new Error(a._data.message)}})},async storeRequest(){await d("/api/request-supplier/resource",{method:"POST",body:this.createRequest.form,watch:!1,onResponse:({response:a})=>{if(a.ok)this.reloadResources(),this.successMessage=a._data.message;else throw this.errorMessage=a._data.message,new Error(a._data.message)}})},async deleteAttachment(a){await d("/api/request-supplier/uploads/"+a,{method:"DELETE",onRequest:()=>{this.attachments.isLoading=!0},onResponse:({response:s})=>{if(this.attachments.isLoading=!1,s.ok)s._data.data&&(this.attachments.data=s._data.data,this.attachments.isLoaded=!0),this.successMessage=s._data.message;else throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async updateAttachments(a){return await d("/api/request-supplier/uploads",{method:"POST",onRequest:()=>{this.attachments.isLoading=!0},body:a,watch:!1,onResponse:({response:s})=>{if(this.attachments.isLoading=!1,s.ok)return this.successMessage=s._data.message,this.attachments.data=s._data.data,this.attachments.isLoaded=!0,s._data.data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async updateSupplierRequest(a){return await d("/api/request-supplier/resource/"+a,{method:"PUT",onRequest:()=>{this.editRequest.isLoading=!0},body:this.editRequest.form,watch:!1,onResponse:({response:s})=>{if(this.editRequest.isLoading=!1,s.ok)return this.successMessage=s._data.message,this.editRequest.details=s._data.data,this.attachments.data=s._data.data.uploads,this.editRequest.isLoaded=!0,s._data.data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async getOne(a){return await d("/api/request-supplier/resource/"+a,{method:"GET",params:this.createRequest.params,onResponse:({response:s})=>{if(s.ok)return this.createRequest.details=s._data.data,s._data.data;throw new Error(s._data.message)}})},async editOne(a){return await d("/api/request-supplier/resource/"+a,{method:"GET",onRequest:()=>{this.attachments.isLoading=!0},params:this.editRequest.params,onResponse:({response:s})=>{if(this.attachments.isLoading=!1,s.ok)return this.editRequest.details=s._data.data,this.attachments.data=s._data.data.uploads,s._data.data;throw new Error(s._data.message)}})},async getApprovedSuppliers(){await e("/api/request-supplier/approved-request",{method:"GET",params:this.approvedSuppliers.params,onRequest:()=>{this.approvedSuppliers.isLoading=!0},onResponse:({response:a})=>{if(this.approvedSuppliers.isLoading=!1,a.ok)this.approvedSuppliers.isLoaded=!0,this.approvedSuppliers.list=a._data.data,this.approvedSuppliers.pagination={first_page:a._data.links.first,pages:a._data.meta.links,last_page:a._data.links.last};else throw new Error(a._data.message)}})},async approveApprovalForm(a){this.successMessage="",this.errorMessage="",await e("/api/approvals/approve/RequestSupplier/"+a,{method:"POST",onResponseError:({response:s})=>{throw this.errorMessage=s._data.message,new Error(s._data.message)},onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data}})},async denyApprovalForm(a){this.successMessage="",this.errorMessage="";const s=new FormData;s.append("id",a),s.append("remarks",this.remarks),await e("/api/approvals/disapprove/RequestSupplier/"+a,{method:"POST",body:s,onResponseError:({response:t})=>{throw this.errorMessage=t._data.message,new Error(t._data.message)},onResponse:({response:t})=>{if(t.ok)return this.successMessage=t._data.message,t._data}})},reloadResources(){const a=this.approvalList.list,s=[];this.allRequests.isLoaded&&s.push(this.getAllRequests),this.myRequests.isLoaded&&s.push(this.getMyRequests),this.myApprovals.isLoaded&&s.push(this.getMyApprovals),this.approvedSuppliers.isLoaded&&s.push(this.getApprovedSuppliers),this.$reset(),this.approvalList.list=a,s.forEach(t=>{t()})}}});export{u as A,h as u};
