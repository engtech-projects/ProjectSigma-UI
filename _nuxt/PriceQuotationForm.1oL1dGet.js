import{_ as F}from"./PsDateInput.vue.Dioz8erE.js";import{_ as A}from"./SearchSupplierSelector.vue.WZi4Qcil.js";import{_ as U}from"./PsTextInput.vue.C7eOWbog.js";import{_ as M}from"./PsNumberInput.vue.BU6zn-2O.js";import{q as N,r as V,L as k,o as v,c as x,a as e,x as w,M as q,u as l,v as C,F as T,i as B,G as Q,t as g,b as i,A as O,f as j,s as $,B as E,K as D,C as z,j as G,g as Y,p as K,e as H,_ as J}from"./entry.32UGFqj-.js";import{u as W}from"./pricequotation.T207ntps.js";import{u as X}from"./suppliers.DPePSG36.js";import{u as Z}from"./request.Dhmi1LZ2.js";const ee={class:"overflow-x-auto rounded-lg shadow-md bg-white"},te={class:"min-w-full text-sm text-left border border-gray-200"},se={class:"bg-gray-100"},oe={class:"p-3 border-b text-center"},le=e("th",{class:"p-3 border-b font-medium"}," Item Description ",-1),ae=e("th",{class:"p-3 border-b font-medium"}," Specification ",-1),re=e("th",{class:"p-3 border-b font-medium"}," QTY ",-1),de=e("th",{class:"p-3 border-b font-medium"}," UOM ",-1),ne=e("th",{class:"p-3 border-b font-medium"}," Preferred Brand ",-1),ie=e("th",{class:"p-3 border-b font-medium"}," Actual Brand ",-1),ue=e("th",{class:"p-3 border-b font-medium"}," Unit Price ",-1),ce=e("th",{class:"p-3 border-b font-medium"}," Remarks ",-1),me={class:"p-2 text-center"},pe=["onUpdate:modelValue","aria-label"],_e={class:"p-2 text-center"},fe={class:"p-2 text-center"},be={class:"p-2 text-center"},he={class:"p-2 text-center"},ge={class:"p-2 text-center"},ve={class:"p-2"},xe={class:"p-2"},ye={class:"p-2"},we=["onUpdate:modelValue","disabled"],Ve={__name:"ItemList",props:{modelValue:{required:!0,type:Object}},emits:["update:modelValue"],setup(_){const b=N(_,"modelValue"),u=V(!1),y=()=>{b.value.forEach(c=>{c.selected=u.value})};return k(b,c=>{u.value=c.length>0&&c.every(t=>t.selected)},{deep:!0}),(c,t)=>{const d=U,m=M;return v(),x("div",ee,[e("table",te,[e("thead",se,[e("tr",null,[e("th",oe,[w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>C(u)?u.value=o:null),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded","aria-label":"Select All Items",onChange:y},null,544),[[q,l(u)]])]),le,ae,re,de,ne,ie,ue,ce])]),e("tbody",null,[(v(!0),x(T,null,B(b.value,(o,f)=>(v(),x("tr",{key:f,class:Q(["border-b hover:bg-gray-50 transition",o.selected?"bg-blue-50":"bg-gray-50/50"])},[e("td",me,[w(e("input",{"onUpdate:modelValue":n=>o.selected=n,type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded","aria-label":`Select item ${f+1}`},null,8,pe),[[q,o.selected]])]),e("td",_e,g(o.item_description),1),e("td",fe,g(o.specification),1),e("td",be,g(o.quantity),1),e("td",he,g(o.uom),1),e("td",ge,g(o.preferred_brand),1),e("td",ve,[i(d,{modelValue:o.actual_brand,"onUpdate:modelValue":n=>o.actual_brand=n,disabled:!o.selected,class:"w-full disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed",placeholder:"Enter Brand"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e("td",xe,[i(m,{modelValue:o.unit_price,"onUpdate:modelValue":n=>o.unit_price=n,disabled:!o.selected,class:"w-full disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed",placeholder:"Enter Price"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),e("td",ye,[w(e("textarea",{"onUpdate:modelValue":n=>o.remarks_during_canvass=n,placeholder:"Remarks",rows:"2",disabled:!o.selected,class:"w-full px-3 py-1.5 border border-slate-400 rounded-md text-sm resize-none focus:ring focus:ring-blue-200 focus:outline-none disabled:bg-gray-100 disabled:text-gray-500 disabled:cursor-not-allowed"},null,8,we),[[O,o.remarks_during_canvass]])])],2))),128))])])])}}},S=_=>(K("data-v-2b2be583"),_=_(),H(),_),Se={class:"text-gray-500 p-2"},qe=["onSubmit"],$e={class:"flex flex-col gap-4 pt-4 w-full"},Ue={class:"basis-[10%] grow-1 shrink-0 flex items-center justify-center rounded-t mb-4"},ke={key:0,class:"pl-4 text-xl font-bold text-gray-900 p-4 tracking-wide"},Ce={class:"flex flex-col gap-4 mb-5"},Ie={class:"flex flex-row justify-between gap-4"},Pe={class:"w-full flex flex-col gap-2"},Le={class:"w-full"},Re={class:"flex flex-row items-center gap-2"},Fe={class:"grid grid-cols w-full gap-y-2 mb-2 mt-1"},Ae=S(()=>e("label",{class:"text-sm font-medium text-gray-600"},"Supplier:",-1)),Me={class:"flex flex-row items-center gap-2"},Ne={class:"flex flex-row items-center gap-2"},Te={class:"w-full flex flex-col gap-2"},Be={class:"w-full"},Qe=S(()=>e("div",{class:"w-full p-4 bg-white rounded-lg"},[e("p",{class:"text-sm font-medium text-gray-900"}," Your promptness in giving us the price quotation of the above mentioned items is highly appreciated. ")],-1)),Oe=S(()=>e("div",{class:"flex w-full justify-end items-center gap-4 no-print"},[e("button",{type:"submit",class:"text-white bg-emerald-700 hover:bg-emerald-800 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center"}," Submit ")],-1)),je=j({__name:"PriceQuotationForm",emits:["submit-success"],setup(_,{emit:b}){const u=W(),y=X(),c=Z(),{createRequest:t}=$(u),{viewRequests:d}=$(c),m=E(),o=V([]),f=V(!1);D(()=>{var a,s,p;(a=d.value.details)!=null&&a.requisition_slip&&(t.value.form.date=new Date().toISOString().split("T")[0],t.value.form.conso_reference_no=((s=d.value.details.requisition_slip)==null?void 0:s.reference_no)||"",o.value=d.value.details.requisition_slip.items||[],f.value=(p=d.value.details.requisition_slip.remarks)==null?void 0:p.toLowerCase().includes("consolidated"))}),k(()=>d.value.details,a=>{var s,p;a!=null&&a.requisition_slip&&(t.value.form.date=new Date().toISOString().split("T")[0],t.value.form.conso_reference_no=((s=d.value.details.requisition_slip)==null?void 0:s.reference_no)||"",o.value=d.value.details.requisition_slip.items||[],f.value=(p=d.value.details.requisition_slip.remarks)==null?void 0:p.toLowerCase().includes("consolidated"))},{deep:!0});const n=z(()=>o.value.filter(a=>a.selected===!0)||[]),I=async()=>{try{if(n.value.length===0){m.add({type:"warning",text:"Please add items before submitting the request."});return}if(!t.value.form.supplier_id){m.add({type:"warning",text:"A supplier is required to submit the request."});return}t.value.form.items=n.value,await u.storeRequest(d.value.details.id),m.add({type:"success",text:t.value.successMessage||"Price Quotation created successfully."}),b("submit-success")}catch(a){m.add({type:"error",text:a||"An unexpected error occurred"})}},P=async a=>{if(!a){t.value.form.address="",t.value.form.contact_person="",t.value.form.contact_no="";return}try{const{data:s}=await y.getOne(a);s&&(t.value.form.address=s.company_address,t.value.form.contact_person=s.contact_person_name,t.value.form.contact_no=s.contact_person_number)}catch(s){m.add({type:"error",text:s||"Failed to load supplier details"})}};return(a,s)=>{const p=F,L=A,h=U,R=Ve;return v(),x("div",Se,[e("form",{onSubmit:Y(I,["prevent"])},[e("div",$e,[e("div",Ue,[a.title?(v(),x("h3",ke," Create Price Quotation ")):G("",!0)]),e("div",Ce,[e("div",Ie,[e("div",Pe,[e("div",Le,[e("div",Re,[i(p,{modelValue:l(t).form.date,"onUpdate:modelValue":s[0]||(s[0]=r=>l(t).form.date=r),disabled:!0,required:!1,class:"w-full",title:"Date"},null,8,["modelValue"])]),e("div",Fe,[Ae,i(L,{modelValue:l(t).form.supplier_id,"onUpdate:modelValue":s[1]||(s[1]=r=>l(t).form.supplier_id=r),title:"Supplier Name",onSupplierSelected:P},null,8,["modelValue"])]),e("div",Me,[i(h,{modelValue:l(t).form.address,"onUpdate:modelValue":s[2]||(s[2]=r=>l(t).form.address=r),disabled:!0,required:!1,class:"w-full",title:"Address"},null,8,["modelValue"])]),e("div",Ne,[i(h,{modelValue:l(t).form.contact_person,"onUpdate:modelValue":s[3]||(s[3]=r=>l(t).form.contact_person=r),disabled:!0,required:!1,class:"w-full",title:"Contact Person"},null,8,["modelValue"])])])]),e("div",Te,[i(h,{modelValue:l(t).form.quotation_no,"onUpdate:modelValue":s[4]||(s[4]=r=>l(t).form.quotation_no=r),disabled:!0,required:!1,class:"w-full",title:"Quotation Number",placeholder:"Generated after submission"},null,8,["modelValue"]),i(h,{modelValue:l(t).form.conso_reference_no,"onUpdate:modelValue":s[5]||(s[5]=r=>l(t).form.conso_reference_no=r),disabled:!0,required:!1,class:"w-full",title:(l(f)?"Conso":"")+"Reference No."},null,8,["modelValue","title"]),i(h,{modelValue:l(t).form.contact_no,"onUpdate:modelValue":s[6]||(s[6]=r=>l(t).form.contact_no=r),disabled:!0,required:!1,class:"w-full",title:"Contact No."},null,8,["modelValue"])])]),e("div",Be,[i(R,{modelValue:l(o),"onUpdate:modelValue":s[7]||(s[7]=r=>C(o)?o.value=r:null)},null,8,["modelValue"])]),Qe,Oe])])],40,qe)])}}}),We=J(je,[["__scopeId","data-v-2b2be583"]]);export{We as _};
