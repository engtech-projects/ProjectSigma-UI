import{e as i,i as a}from"./CustomFetch.ggXvTdIz.js";import{l as o}from"./entry.32UGFqj-.js";const c=o("priceQuotationStore",{state:()=>({allPQList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{}},createRequest:{isLoading:!1,isLoaded:!1,list:[],details:{},form:{supplier_id:0,date:"",address:"",contact_person:"",contact_no:"",conso_reference_no:"",quotation_no:"",items:[]},params:{},pagination:{},errorMessage:"",successMessage:""},editRequest:{isLoading:!1,isLoaded:!1,details:{},form:{supplier_id:0,date:"",address:"",contact_person:"",contact_no:"",conso_reference_no:"",quotation_no:"",items:[]},params:{},pagination:{}},priceQuotationList:{isLoading:!1,isLoaded:!1,list:[],details:{},params:{},pagination:{},errorMessage:"",successMessage:""},priceQuotation:{isLoading:!1,isLoaded:!1,list:[],details:{},params:{},pagination:{},errorMessage:"",successMessage:""},quotationsForCanvass:{isLoading:!1,list:[],params:{},errorMessage:"",successMessage:""},selectedItem:"",errorMessage:"",successMessage:"",remarks:""}),actions:{async getQuotationsForCanvass(t){await i("/api/procurement-request/quotations-for-canvass/"+t,{method:"GET",params:this.quotationsForCanvass.params,onRequest:()=>{this.quotationsForCanvass.isLoading=!0},onResponseError:({response:e})=>{var s;throw this.quotationsForCanvass.isLoading=!1,this.quotationsForCanvass.errorMessage=((s=e==null?void 0:e._data)==null?void 0:s.message)||"Unexpected server error while creating canvass summary.",new Error(this.quotationsForCanvass.errorMessage||"Unexpected server error while creating canvass summary.")},onResponse:({response:e})=>{this.quotationsForCanvass.isLoading=!1,e.ok&&(this.quotationsForCanvass.list=e._data.data)}})},async storeRequest(t){this.clearMessages(),await a(`/api/procurement-request/${t}/create-price-quotation`,{method:"POST",body:this.createRequest.form,onRequest:()=>{this.createRequest.isLoading=!0},onResponse:({response:e})=>{e.ok&&(this.reloadResources(),this.createRequest.successMessage=e._data.message,this.createRequest.form={supplier_id:0,date:"",address:"",contact_person:"",contact_no:"",conso_reference_no:"",quotation_no:"",items:[]}),this.createRequest.isLoading=!1},onResponseError:({response:e})=>{var s;throw this.createRequest.isLoading=!1,this.createRequest.errorMessage=((s=e==null?void 0:e._data)==null?void 0:s.message)||"Unexpected server error while creating price quotation.",new Error(this.createRequest.errorMessage||"Unexpected server error while creating price quotation.")}})},async getPriceQuotationDetails(t){return await a("/api/procurement-request/price-quotation/"+t,{method:"GET",params:this.priceQuotation.params,onResponse:({response:e})=>{if(e.ok)return this.priceQuotation.details=e._data.data,e._data.data;throw new Error(e._data.message)}})},async updatePriceQuotationItem(t,e){try{return this.priceQuotationList.isLoading=!0,this.clearMessages(),await a(`/api/procurement-request/price-quotation-item/${t}`,{method:"PUT",body:e,watch:!1,onResponse:({response:s})=>{if(this.priceQuotationList.isLoading=!1,s.ok)return this.successMessage=s._data.message,s._data.data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})}catch(s){throw this.priceQuotationList.isLoading=!1,this.errorMessage=s.message||"Failed to update price quotation item",s}},clearMessages(){this.errorMessage="",this.successMessage="",this.priceQuotationList.errorMessage="",this.priceQuotationList.successMessage=""},reloadResources(){const t=[];let e=null;this.priceQuotation.isLoaded&&(e=this.priceQuotation.details.id),this.priceQuotationList.isLoaded&&t.push(()=>this.getPriceQuotationList(this.priceQuotationList.details.request_procurement_id)),this.$reset(),t.forEach(s=>{s()}),e&&this.getPriceQuotationList(e)}}});export{c as u};
