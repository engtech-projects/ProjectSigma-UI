import{o as n,c as i,a as s,t as m,x as p,y,u as r,G as R,F as T,i as S,j as v,b as M,d as P,l as k,r as F,B as I,z as C,_ as E,ab as $,h as L}from"./entry.32UGFqj-.js";import{A as u}from"./enums.DZVv3ml5.js";import{a as N}from"./Accessibilities.xGffDRXj.js";import{u as D}from"./transactionFlowModel.BiQcH7fG.js";import{u as g,a as w}from"./CustomFetch.ggXvTdIz.js";const O={class:"bg-white text-gray-500 px-2 shadow-lg py-2"},G={class:"flex items-center gap-3"},U={class:"text-md font-bold text-center"},z={__name:"TransactionFlowHeader",props:{title:{type:String,default:""}},setup(t){return(e,a)=>(n(),i("div",O,[s("div",G,[s("h2",U,m(t.title),1)])]))}},B={class:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24"},V=s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),j=s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),H=[V,j],Q={class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Y=s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1),W=[Y],J={class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},K=s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1),X=[K],x={__name:"ProgressIndicator",props:{indicatorStatusType:{type:String,required:!0,default:u.PENDING}},setup(t){return(e,a)=>(n(),i("div",null,[s("div",{class:R(["w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300",t.indicatorStatusType===("AccountingProgressIndicatorTypeStatus"in e?e.AccountingProgressIndicatorTypeStatus:r(u)).DONE?"bg-green-500 text-white":t.indicatorStatusType===("AccountingProgressIndicatorTypeStatus"in e?e.AccountingProgressIndicatorTypeStatus:r(u)).IN_PROGRESS?"bg-yellow-500 text-white":"bg-gray-200 text-gray-400"])},[p((n(),i("svg",B,H,512)),[[y,t.indicatorStatusType===("AccountingProgressIndicatorTypeStatus"in e?e.AccountingProgressIndicatorTypeStatus:r(u)).PENDING]]),p((n(),i("svg",Q,W,512)),[[y,t.indicatorStatusType===("AccountingProgressIndicatorTypeStatus"in e?e.AccountingProgressIndicatorTypeStatus:r(u)).DONE]]),p((n(),i("svg",J,X,512)),[[y,t.indicatorStatusType===("AccountingProgressIndicatorTypeStatus"in e?e.AccountingProgressIndicatorTypeStatus:r(u)).IN_PROGRESS]])],2)]))}},Z={class:"p-2"},tt={class:"space-y-4"},et={class:"flex items-center gap-4"},st={class:"flex-1"},at={key:0,class:"mb-2"},ot=s("span",{class:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800"},[s("div",{class:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),P(" In Progress ")],-1),nt=[ot],it={class:"text-md font-semibold text-black leading-relaxed"},rt={class:"text-xs font-semibold text-gray-500 leading-relaxed"},lt={__name:"TransactionFLowCreate",props:{transactionFlowModelList:{type:Array,default:()=>[]}},setup(t){const e=t;return(a,d)=>{const c=x;return n(),i("div",Z,[s("div",tt,[(n(!0),i(T,null,S(e.transactionFlowModelList,(l,h)=>(n(),i("div",{key:h,class:"relative group transition-all duration-300 hover:transform hover:scale-[1.02]"},[s("div",{class:R(["relative z-10 rounded-xl p-2 border-1 transition-all duration-300",h===0?"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 shadow-md":"bg-gray-50 border-gray-200 hover:border-gray-300"])},[s("div",et,[s("div",st,[h===0?(n(),i("div",at,nt)):v("",!0),s("p",it,m(l.name?l.name.toUpperCase():"NO NAME"),1),p(s("p",rt," User Assignee: ",512),[[y,l.is_assignable]]),p(s("p",{class:"text-xs font-semibold text-gray-500 leading-relaxed"},m(l.user_name?l.user_name.toUpperCase():"NO ASSIGN"),513),[[y,l.is_assignable]])]),M(c,{"indicator-status-type":h===0?("AccountingProgressIndicatorTypeStatus"in a?a.AccountingProgressIndicatorTypeStatus:r(u)).IN_PROGRESS:("AccountingProgressIndicatorTypeStatus"in a?a.AccountingProgressIndicatorTypeStatus:r(u)).PENDING},null,8,["indicator-status-type"])])],2)]))),128))])])}}},dt=k("paymentRequestStore",{state:()=>({allRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},myRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},myApprovals:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},myDeniedRequests:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},paymentRequest:{isLoading:!1,id:null,prf_no:null,stakeholder_id:null,request_date:null,total:0,total_vat_amount:0,isWithHolingTax:!0,withholding_tax_id:null,description:"",approvals:[],details:[],attachment_file_names:"",stakeholderInformation:{},errorMessage:"",successMessage:""},paymentRequestAttachmentData:{isLoading:!1,attachment_files:"",errorMessage:"",successMessage:""},successMessage:"",errorMessage:"",particularGroups:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},vat:null,list:[],pagination:{},getParams:{},params:{},isLoading:{list:!1,show:!1,create:!1,edit:!1,delete:!1},remarks:"",isEdit:!1}),getters:{},actions:{async getAllRequests(){this.allRequests.isLoaded=!0,await g("/api/npo/resource",{method:"GET",params:this.allRequests.params,onRequest:()=>{this.allRequests.isLoading=!0},onResponse:({response:t})=>{this.allRequests.isLoading=!1,t.ok&&(this.allRequests.list=t._data.data.data,this.allRequests.pagination={first_page:t._data.data.links.first,pages:t._data.data.meta.links,last_page:t._data.data.links.last})}})},async getMyRequests(){this.myRequests.isLoaded=!0,await g("/api/npo/my-requests",{method:"GET",params:this.myRequests.params,onRequest:()=>{this.myRequests.isLoading=!0},onResponse:({response:t})=>{this.myRequests.isLoading=!1,t.ok&&(this.myRequests.list=t._data.data.data,this.myRequests.pagination={first_page:t._data.data.links.first,pages:t._data.data.meta.links,last_page:t._data.data.links.last})}})},async getMyApprovals(){this.myApprovals.isLoaded=!0,await g("/api/npo/my-approvals",{method:"GET",params:this.myApprovals.params,onRequest:()=>{this.myApprovals.isLoading=!0},onResponse:({response:t})=>{this.myApprovals.isLoading=!1,t.ok&&(this.myApprovals.list=t._data.data.data,this.myApprovals.pagination={first_page:t._data.data.links.first,pages:t._data.data.meta.links,last_page:t._data.data.links.last})}})},async getMyDeniedRequests(){this.myDeniedRequests.isLoaded=!0,await g("/api/npo/my-denied-requests",{method:"GET",params:this.myDeniedRequests.params,onRequest:()=>{this.myDeniedRequests.isLoading=!0},onResponse:({response:t})=>{this.myDeniedRequests.isLoading=!1,t.ok&&(this.myDeniedRequests.list=t._data.data,this.myDeniedRequests.pagination={first_page:t._data.links.first,pages:t._data.meta.links,last_page:t._data.links.last})}})},async uploadAttachments(){this.paymentRequestAttachmentData.isLoading=!0;const t=new FormData;for(const e of this.paymentRequestAttachmentData.attachment_files)t.append("attachment_files[]",e);t.append("attachment_file_names",this.paymentRequest.attachment_file_names),await w("/api/npo/upload-attachment",{method:"POST",body:t,watch:!1,onRequest:()=>{this.paymentRequestAttachmentData.isLoading=!0},onResponseError:({response:e})=>{throw this.paymentRequestAttachmentData.errorMessage=e._data.message,new Error(e._data.message)},onResponse:({response:e})=>{if(this.paymentRequestAttachmentData.isLoading=!1,e.ok)this.paymentRequest.attachment_file_names=e._data.data,this.paymentRequestAttachmentData.successMessage=e._data.message;else throw this.paymentRequestAttachmentData.errorMessage=e._data.message,new Error(e._data.message)}})},async addPaymentRequest(){this.paymentRequest.successMessage="",this.paymentRequest.errorMessage="",await w("/api/payment-request",{method:"POST",body:this.paymentRequest,watch:!1,onRequest:()=>{this.paymentRequest.isLoading=!0},onResponseError:({response:t})=>{throw this.paymentRequest.errorMessage=t._data.message,new Error(t._data.message)},onResponse:({response:t})=>{if(this.paymentRequest.isLoading=!1,t.ok)this.reloadResources(),this.paymentRequestAttachmentData.attachment_files="",this.paymentRequest.successMessage=t._data.message;else throw this.paymentRequest.errorMessage=t._data.message,new Error(t._data.message)}})},async getVat(){this.isLoading.show=!0;const{data:t,error:e}=await g("/api/vat-value",{method:"GET",params:this.getParams,onResponse:({response:a})=>{this.isLoading.show=!1,this.vat=a._data.vat}});if(t)return t;if(e)return e},async editPaymentRequest(){this.paymentRequest.isLoading=!0;const{data:t,error:e}=await g("/api/payment-request/"+this.paymentRequest.id,{method:"PATCH",body:this.paymentRequest,watch:!1,onRequest:()=>{this.paymentRequest.isLoading=!0}});if(this.paymentRequest.isLoading=!1,t.value)return this.paymentRequest.successMessage="Payment request successfully updated.",t;if(e.value)return this.paymentRequest.errorMessage=e.value.data.message,e},async editForm(t,e){this.isLoading.show=!0,this.isLoading.edit=!0;const{data:a,error:d}=await g("/api/form/"+e+"/"+t,{method:"PUT",body:{},watch:!1});if(a.value)return this.isLoading.show=!1,this.isLoading.edit=!1,this.paymentRequest.successMessage="Form successfully updated",a;if(d.value)return this.isLoading.edit=!1,this.paymentRequest.errorMessage=d.value.data.message,d},async generatePrNo(){await g("/api/npo/generate-prf-no",{method:"GET",onResponse:({response:t})=>{t.ok&&(this.paymentRequest.prf_no=t._data.data)}})},async approveApprovalForm(t){this.successMessage="",this.errorMessage="",await w("/api/approvals/approve/ACCOUNTING_PAYMENT_REQUEST/"+t,{method:"POST",onResponseError:({response:e})=>{throw this.errorMessage=e._data.message,new Error(e._data.message)},onResponse:({response:e})=>{if(e._data.success)return this.reloadResources(),this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async denyApprovalForm(t){this.successMessage="",this.errorMessage="",await w("/api/approvals/disapprove/ACCOUNTING_PAYMENT_REQUEST/"+t,{method:"POST",body:{remarks:this.remarks},onResponseError:({response:e})=>{throw this.errorMessage=e._data.message,new Error(e._data.message)},onResponse:({response:e})=>{if(e.ok)return this.reloadResources(),this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},reloadResources(){const t=this.paymentRequest.approvals,e=[];e.push(this.generatePrNo),this.allRequests.isLoaded&&e.push(this.getAllRequests),this.myRequests.isLoaded&&e.push(this.getMyRequests),this.myApprovals.isLoaded&&e.push(this.getMyApprovals),this.myDeniedRequests.isLoaded&&e.push(this.getMyDeniedRequests),this.$reset(),this.paymentRequest.approvals=t,e.forEach(a=>{a()})},async getOne(t){return await g("api/payment-request/"+t,{method:"GET",params:this.getParams,onResponse:({response:e})=>{if(e.ok)return e._data.data;throw new Error(e._data.message)}})}}}),ct={class:"relative group transition-all duration-300 hover:transform hover:scale-[1.02]"},ut={class:"flex items-center gap-4"},gt={class:"flex-1"},mt={key:0,class:"mb-2"},ht={key:0,class:"w-2 h-2 bg-current rounded-full animate-pulse"},pt={class:"text-md font-semibold text-black leading-relaxed"},yt={class:"text-xs font-semibold text-gray-500 leading-relaxed"},ft={class:"w-full flex justify-end pt-2"},_t=["disabled"],wt={__name:"TransactionFLowCard",props:{transactionFlowModel:{type:Object,default:()=>{}},userData:{type:Object,default:()=>{}}},emits:["closeModal"],setup(t,{emit:e}){const a=D(),d=dt(),c=F(!1),l=I(),h=async(o,f)=>{c.value=!0;try{await a.updateTransactionFlowStatus(o,f),l.add({type:"success",text:a.successMessage}),d.getAllRequests(),e("closeModal")}catch(_){l.add({type:"error",text:_||"something went wrong."})}finally{c.value=!1}},q=o=>{switch(o){case"done":return"bg-gradient-to-r from-green-50 to-emerald-50 border-green-200 shadow-md";case"pending":default:return"bg-gray-50 border-gray-200 hover:border-gray-300"}},A=o=>{switch(o){case"done":return"bg-green-100 text-green-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"pending":default:return"bg-gray-100 text-gray-700"}},b=o=>{switch(o){case"done":return"Done";case"in_progress":return"In Progress";case"pending":default:return"Pending"}};return(o,f)=>{const _=x;return n(),i("div",ct,[s("div",{class:R(["relative z-10 rounded-xl p-2 border-1 transition-all duration-300",t.transactionFlowModel.status==="in_progress"?"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 shadow-md":q(t.transactionFlowModel.status)])},[s("div",ut,[s("div",gt,[t.transactionFlowModel.status?(n(),i("div",mt,[s("span",{class:R(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium",A(t.transactionFlowModel.status)])},[t.transactionFlowModel.status==="in_progress"?(n(),i("div",ht)):v("",!0),P(" "+m(b(t.transactionFlowModel.status)),1)],2)])):v("",!0),s("p",pt,m(t.transactionFlowModel.name?t.transactionFlowModel.name.toUpperCase():"NO NAME"),1),p(s("p",yt," User Assignee: ",512),[[y,t.transactionFlowModel.is_assignable]]),p(s("p",{class:"text-xs font-semibold text-gray-500 leading-relaxed"},m(t.transactionFlowModel.user_name?t.transactionFlowModel.user_name.toUpperCase():"NO ASSIGN"),513),[[y,t.transactionFlowModel.is_assignable]])]),M(_,{"indicator-status-type":t.transactionFlowModel.status==="pending"?("AccountingProgressIndicatorTypeStatus"in o?o.AccountingProgressIndicatorTypeStatus:r(u)).PENDING:t.transactionFlowModel.status==="done"?("AccountingProgressIndicatorTypeStatus"in o?o.AccountingProgressIndicatorTypeStatus:r(u)).DONE:("AccountingProgressIndicatorTypeStatus"in o?o.AccountingProgressIndicatorTypeStatus:r(u)).IN_PROGRESS},null,8,["indicator-status-type"])]),p(s("div",ft,[s("button",{class:"bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded",disabled:r(c),onClick:f[0]||(f[0]=kt=>h(t.transactionFlowModel.id,t.transactionFlowModel.user_id))},m(r(c)?"Loading...":"Mark as done"),9,_t)],512),[[y,t.transactionFlowModel.status==="in_progress"&&("useCheckIsCurrentUser"in o?o.useCheckIsCurrentUser:r(N))(t.transactionFlowModel.user_id)]])],2)])}}},Rt={key:0,class:"mt-4 bg-white rounded-lg shadow-md p-4"},vt={class:"flex items-center gap-3"},Mt=s("span",{class:"text-sm font-medium text-gray-600"},"Progress:",-1),qt={class:"flex-1 bg-gray-200 rounded-full h-2"},At={class:"text-sm font-medium text-gray-600"},bt={__name:"TransactionProgress",props:{transactionFlowModelList:{type:Array,default:()=>[]},transactionOption:{type:String,default:"create"}},setup(t){const e=t,a=()=>e.transactionFlowModelList.length===0?0:e.transactionOption==="create"?1/e.transactionFlowModelList.length*100:d()/e.transactionFlowModelList.length*100,d=()=>e.transactionOption==="create"?1:e.transactionFlowModelList.filter(c=>c.status==="done").length;return(c,l)=>e.transactionFlowModelList.length>0?(n(),i("div",Rt,[s("div",vt,[Mt,s("div",qt,[s("div",{class:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-500",style:C({width:`${a()}%`})},null,4)]),s("span",At,m(d())+" of "+m(e.transactionFlowModelList.length),1)])])):v("",!0)}},Lt={class:"w-full max-w-4xl mx-auto border-t-4 border-t-green-600 shadow-lg"},Tt={class:"bg-white rounded-b-xl shadow-lg overflow-hidden"},St={key:1,class:"p-2"},Pt={class:"space-y-4"},xt={__name:"TransactionFlow",props:{transactionOption:{type:String,default:"create"},transactionFlowModelList:{type:Array,default:()=>[]}},emits:["closeModal"],setup(t,{emit:e}){const a=t,{data:d}=$();return(c,l)=>{const h=z,q=lt,A=wt,b=bt;return n(),i("div",Lt,[M(h,{title:"PRF Transaction Flow"}),s("div",Tt,[t.transactionOption==="create"?(n(),L(q,{key:0,"transaction-flow-model-list":t.transactionFlowModelList},null,8,["transaction-flow-model-list"])):(n(),i("div",St,[s("div",Pt,[(n(!0),i(T,null,S(t.transactionFlowModelList,(o,f)=>(n(),L(A,{key:f,"transaction-flow-model":o,"user-data":r(d),onCloseModal:l[0]||(l[0]=_=>e("closeModal"))},null,8,["transaction-flow-model","user-data"]))),128))])]))]),M(b,{"transaction-flow-model-list":t.transactionFlowModelList,"transaction-option":a.transactionOption},null,8,["transaction-flow-model-list","transaction-option"])])}}},Nt=E(xt,[["__scopeId","data-v-fbaa6d6c"]]);export{Nt as _,dt as u};
