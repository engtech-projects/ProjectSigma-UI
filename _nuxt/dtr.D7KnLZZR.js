import{j as n,l as u,m as o}from"./Utilities.DofxnkSu.js";import{b as i}from"./CustomFetch.ggXvTdIz.js";import{l}from"./entry.32UGFqj-.js";const g=l("myDTRSTORE",{state:()=>({employee_dtr:{dtr:{}},employee_dtr_v2:{dtr:{}},v2IsLoading:!1,successMessage:"",errorMessage:"",getEmployeeDTRv2Data:{isLoading:!1,params:{employee_id:null,cutoff_start:n(u()),cutoff_end:n(o())},data:{},successMessage:"",errorMessage:""}}),getters:{dtrUniqueSchedules(e){if(!e.employee_dtr)return[];const s=Object.values(e.employee_dtr.dtr).map(a=>[...a.schedules_attendances]).flat(1);return s.filter((a,r)=>r===s.findIndex(t=>a.start_time_human===t.start_time_human&&a.end_time_human===t.end_time_human))},dtrUniqueOvertime(e){if(!e.employee_dtr)return[];const s=Object.values(e.employee_dtr.dtr).map(a=>[...a.overtime]).flat(1);return s.filter((a,r)=>r===s.findIndex(t=>a.start_time_human===t.start_time_human&&a.end_time_human===t.end_time_human))},dtrUniqueSchedulesV2(e){var a,r;if(!((a=e.getEmployeeDTRv2Data.data)!=null&&a.dtr))return[];const s=Object.values(((r=e.getEmployeeDTRv2Data.data)==null?void 0:r.dtr)??[]).map(t=>[...t.metadata.summary.schedules]).flat(1);return s.filter((t,m)=>m===s.findIndex(d=>t.start_time_sched===d.start_time_sched&&t.end_time_sched===d.end_time_sched))},dtrUniqueOvertimeV2(e){var a,r;if(!((a=e.getEmployeeDTRv2Data.data)!=null&&a.dtr))return[];const s=Object.values(((r=e.getEmployeeDTRv2Data.data)==null?void 0:r.dtr)??[]).map(t=>[...t.metadata.summary.overtimes]).flat(1);return s.filter((t,m)=>m===s.findIndex(d=>t.start_time_sched===d.start_time_sched&&t.end_time_sched===d.end_time_sched))},dtrUniqueScheduleNamesV2(e){var a,r;if(!((a=e.getEmployeeDTRv2Data.data)!=null&&a.dtr))return"";const s=Object.values(((r=e.getEmployeeDTRv2Data.data)==null?void 0:r.dtr)??[]).map(t=>[...t.metadata.summary.schedules]).flat(1);return s.filter((t,m)=>m===s.findIndex(d=>t.sched_from===d.sched_from)).map(t=>t.sched_from).join(", ")}},actions:{async getEmployeeDTR(e,s,a){this.successMessage="",this.errorMessage="",await i("/api/attendance/dtr",{params:{employee_id:e,cutoff_start:s,cutoff_end:a},method:"GET",onResponse:({response:r})=>{if(r.ok)this.successMessage=r._data.message,this.employee_dtr=r._data.data;else throw this.errorMessage=r._data.message,new Error(r._data.message)}})},async getEmployeeDTRV2(){this.successMessage="",this.errorMessage="",await i("/api/v2/attendance/dtr",{params:this.getEmployeeDTRv2Data.params,method:"GET",onRequest:()=>{this.getEmployeeDTRv2Data.isLoading=!0},onResponse:({response:e})=>{if(this.getEmployeeDTRv2Data.isLoading=!1,e.ok)this.getEmployeeDTRv2Data.successMessage=e._data.message,this.getEmployeeDTRv2Data.data=e._data.data;else throw this.getEmployeeDTRv2Data.errorMessage=e._data.message,new Error(e._data.message)}})}}});export{g as u};
