import{_ as B}from"./SearchProfile.ahiduUkZ.js";import D from"./Icon.CrHlyQOo.js";import{r as h,B as L,Q as I,o as n,c as i,u as c,F as P,a as e,t as C,b as u,d as g,G as R,j as M,f as N,h as $,w as T}from"./entry.32UGFqj-.js";import{m as U,s as z,d as H,r as O}from"./interval.BLVulaED.js";import{j as E,h as A,B as V,r as W,D as G,u as Q,n as x,c as q}from"./attendancePortal.j6cfMurj.js";import{u as J}from"./search-bar.vue.DimEkj6Y.js";import{_ as K}from"./AcessContainer.Dum7aOuo.js";import{u as X}from"./vue.f36acd1f.Ds2AlAv6.js";import{u as Y,A as Z}from"./Accessibilities.xGffDRXj.js";import"./index.T-zbMaZc.js";import"./CustomFetch.ggXvTdIz.js";import"./PsSelectSearch.vue.CT-F0Leg.js";import"./employeeSearch.AgeAeP2j.js";import"./users.G4iuGzk0.js";function ee(v,a){var f=Array.isArray(a)?a:[a];f.forEach(function(t){var d=t instanceof E?t.score:A(t)?t.detection.score:void 0,r=t instanceof E?t.box:A(t)?t.detection.box:new V(t),m=d?""+W(d):void 0;new G(r,{label:m}).draw(v)})}const te={class:"m-auto"},ae={key:0,class:"text-xl justify-center items-center flex-col p-2"},se={class:"text-center"},oe={key:0},ne={class:"text-center"},ce={key:1},ie={class:"text-center"},re={key:1},le=e("p",{class:"text-gray-500 text-xl justify-center flex mt-auto py-2"}," Search for Employee on the Left ",-1),de=[le],me={class:"w-full flex-col gap-2 justify-center"},ue=e("div",{class:"flex justify-center items-center"},[e("div",{class:"relative"},[e("video",{id:"cameraPreview",class:"relative",height:"500",width:"500",autoplay:"",muted:""}),e("div",{id:"capturedImage",class:"absolute top-0"})])],-1),fe={key:0},_e={class:"text-gray-900 text-xl justify-center flex mt-auto py-2"},pe={key:1},he=e("p",{class:"text-gray-500 text-xl justify-center flex mt-auto py-2"}," NO FACE DETECTED ",-1),ye=[he],ge={class:"flex justify-end py-4"},ve={class:"flex gap-2"},xe=["disabled"],be={key:1,class:"flex justify-center"},b="/faceapimodels",we={__name:"FaceDetection",setup(v){const a=J(),f=Q();let t=null;const d=h(null),r=h(null),m=L(),_=h(!1),w=h(null),k=h(!1);I(()=>{t&&t.getTracks().forEach(s=>{s.stop()})});const j=()=>{k.value=!0,Promise.all([x.ssdMobilenetv1.loadFromUri(b),x.faceLandmark68Net.loadFromUri(b),x.faceRecognitionNet.loadFromUri(b)]).then(async()=>{const s=document.getElementById("cameraPreview");t=await navigator.mediaDevices.getUserMedia({video:!0}),d.value=t,s.srcObject=t,await new Promise(o=>{s.onloadedmetadata=()=>{s.play(),o()}}),s.addEventListener("play",()=>{const o=q(s);document.getElementById("capturedImage").append(o);const p={width:s.clientWidth,height:s.clientHeight};U(o,p),z(async()=>{try{const l=await H(s).withFaceLandmarks().withFaceDescriptor(),F=O(l,p);o.getContext("2d").clearRect(0,0,o.width,o.height),ee(o,F),l.detection._score>.8?(w.value=l.detection._score,r.value=l,_.value=!0):(r.value=null,_.value=!1)}catch(l){r.value=l,_.value=!1}},1e3)})})},S=async()=>{try{await f.saveOrUpdateEmployeePattern(r.value,a.information.id),m.add({type:"success",text:f.successMessage}),a.getEmployeeInformation(a.information.id)}catch(s){m.add({type:"error",text:s})}};return(s,o)=>{var p,l;const y=D;return n(),i("div",te,[c(k)?(n(),i(P,{key:0},[c(a).information.id?(n(),i("div",ae,[e("p",se,C(c(a).information.fullname_last),1),((l=(p=c(a).information)==null?void 0:p.face_patterns)==null?void 0:l.length)>0?(n(),i("div",oe,[e("p",ne,[u(y,{name:"material-symbols:check-circle",color:"green",class:"w-5 h-5"}),g(" Ready for Facial Recognition ")])])):(n(),i("div",ce,[e("p",ie,[u(y,{name:"material-symbols:cancel",color:"red",class:"w-5 h-5"}),g(" No Facial Marks Saved ")])]))])):(n(),i("div",re,de)),e("div",me,[ue,e("div",null,[c(r)?(n(),i("div",fe,[e("p",_e," Face Landmark Result : %"+C(Math.abs((c(w)*100).toFixed(2))),1)])):(n(),i("div",pe,ye))])]),e("div",ge,[e("div",ve,[c(a).information.id?(n(),i("button",{key:0,disabled:!c(_),class:R([c(_)?"text-white gap-2 bg-teal-700 hover:bg-teal-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-xs px-5 py-2.5 text-center inline-flex items-center dark:bg-teal-600 dark:hover:bg-teal-700 dark:focus:ring-teal-800":"text-white gap-2 bg-orange-700 hover:bg-orange-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-xs px-5 py-2.5 text-center inline-flex items-center dark:bg-orange-600 dark:hover:bg-orange-700 dark:focus:ring-orange-800"]),onClick:o[0]||(o[0]=F=>S())},[u(y,{name:"material-symbols:camera",color:"white",class:"w-5 h-5"}),g(" Save Face Pattern ")],10,xe)):M("",!0)])])],64)):(n(),i("div",be,[e("button",{class:"flex-1 text-white p-2 rounded bg-teal-600 content-center mt-5",onClick:j}," Start Camera ")]))])}}},ke={class:"w-full flex gap-2"},Fe={class:"w-full md:w-1/3"},Ce={class:"shadow-md p-4 bg-white mb-3 border border-gray-300 rounded-lg md:w-2/3 w-full"},Ee={class:"flex gap-3 justify-center text-2xl font-medium text-gray-900 dark:text-white p-2 border-gray-800 border-b-2"},ze=N({__name:"facerecognition",setup(v){return X({title:"Face Login",meta:[{name:"description",content:""}],bodyAttrs:{class:"login"}}),(a,f)=>{const t=B,d=D,r=we,m=K;return n(),$(m,{"if-access":("useCheckAccessibility"in a?a.useCheckAccessibility:c(Y))([("AccessibilityTypes"in a?a.AccessibilityTypes:c(Z)).hrms_attendance_face_recognition])},{default:T(()=>[e("div",ke,[e("div",Fe,[u(t)]),e("div",Ce,[e("p",Ee,[u(d,{name:"material-symbols-light:familiar-face-and-zone",color:"black",class:"w-8 h-8"}),g(" Setup Face Recognition ")]),e("div",null,[u(r)])])])]),_:1},8,["if-access"])}}});export{ze as default};
