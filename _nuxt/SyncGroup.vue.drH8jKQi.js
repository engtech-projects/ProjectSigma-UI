import u from"./Icon.DcF_NU9d.js";import{_ as l}from"./LoadingContainer.vue.Bz3WIh4M.js";import{l as x,f as g,B as h,r as f,o as p,h as y,w as m,a as t,t as _,b as w,u as S,x as v,y as L,aa as D}from"./entry.R6V7NTxy.js";import{u as C,c as k,d as A,e as P}from"./CustomFetch.BRBLzGci.js";const M=x("dataSyncStore",{state:()=>({url:"",api:"",params:{},errorMessage:"",successMessage:"",isLoading:!1,isEdit:!1}),actions:{async syncAccountingData(){this.isLoading=!0;const{data:a,error:e}=await C(this.url,{method:"POST",params:this.params,watch:!1,onResponse:({response:s})=>{this.isLoading=!1,s._data.success&&(this.successMessage=s._data.message),s._data.success||(this.errorMessage=s._data.message)}});if(a)return a;if(e)return e},async syncHrmsData(){this.isLoading=!0;const{data:a,error:e}=await k(this.url,{method:"POST",params:this.params,watch:!1,onResponse:({response:s})=>{this.isLoading=!1,this.successMessage=s._data.message,s._data.success&&(this.successMessage=s._data.message),s._data.success||(this.errorMessage=s._data.message)}});if(a)return a;if(e)return e},async syncProjectData(){this.isLoading=!0;const{data:a,error:e}=await A(this.url,{method:"POST",params:this.params,watch:!1,onResponse:({response:s})=>{this.isLoading=!1,this.successMessage=s._data.message,s._data.success&&(this.successMessage=s._data.message),s._data.success||(this.errorMessage=s._data.message)}});if(a)return a;if(e)return e},async syncInventoryData(){this.isLoading=!0;const{data:a,error:e}=await P(this.url,{method:"POST",params:this.params,watch:!1,onResponse:({response:s})=>{if(this.isLoading=!1,s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}});if(a)return a;if(e)return e},async sync(){this.api==="accounting"&&await this.syncAccountingData(),this.api==="hrms"&&await this.syncHrmsData(),this.api==="project"&&await this.syncProjectData(),this.api==="inventory"&&await this.syncInventoryData()},reset(){this.url="",this.api="",this.errorMessage="",this.successMessage=""}}}),j={class:"flex items-center justify-between px-6 py-2 border-b hover:bg-green-50 relative"},I=t("span",null," Sync ",-1),N=g({__name:"SyncItem",props:{name:{type:String,default:""},url:{type:String,default:""},api:{type:String,default:""}},setup(a){const e=a,s=M(),r=h(),i=f(!1),o=async()=>{try{i.value=!0,s.url=e.url,s.api=e.api.toLowerCase(),await s.sync(),s.errorMessage!==""&&r.add({type:"error",text:s.errorMessage}),s.successMessage!==""&&r.add({type:"success",text:s.successMessage})}catch{r.add({type:"error",text:"something went wrong."})}finally{i.value=!1,s.reset()}};return(n,b)=>{const c=u,d=l;return p(),y(d,{loading:S(i)},{default:m(()=>[t("div",j,[t("span",null,_(e.name),1),t("button",{class:"p-2 border flex gap-2 items-center rounded-md text-xs hover:bg-gray-200 active:bg-white",onClick:o},[w(c,{name:"iconoir:refresh-double"}),I])])]),_:1},8,["loading"])}}}),B={class:"border bg-white rounded-md relative"},R={class:"px-6 py-3 flex justify-between items-center bg-gray-100 font-bold border"},$=t("span",{class:"text-xs"}," Sync Module ",-1),V=g({__name:"SyncGroup",props:{name:{type:String,default:""},url:{type:String,default:""},api:{type:String,default:""},isModuleSync:{type:Boolean,default:!0}},setup(a){const e=a,s=M(),r=h(),i=f(!1),o=async()=>{try{i.value=!0,s.url=e.url,s.api=e.api.toLowerCase(),await s.sync(),s.errorMessage!==""&&r.add({type:"error",text:s.errorMessage}),s.successMessage!==""&&r.add({type:"success",text:s.successMessage})}catch{r.add({type:"error",text:"something went wrong."})}finally{i.value=!1,s.reset()}};return(n,b)=>{const c=u,d=l;return p(),y(d,{loading:S(i)},{default:m(()=>[t("div",B,[t("div",R,[t("h2",null,_(e.name),1),v(t("button",{class:"border border-2-teal-600 rounded-md px-3 py-1 flex items-center gap-2 bg-teal-500 text-white hover:bg-teal-600 active:bg-teal-500",onClick:o},[w(c,{name:"iconoir:refresh-double"}),$],512),[[L,e.isModuleSync]])]),t("div",null,[D(n.$slots,"default")])])]),_:3},8,["loading"])}}});export{N as _,V as a,M as u};
