import{_ as tt,a as et,b as st}from"./MainContainer.B1BT_8sq.js";import{_ as at}from"./PsTextInput.vue.DFQbUHfC.js";import{_ as ot}from"./PsTable.CTJad9K5.js";import{_ as nt}from"./CustomPagination.CR9ildFS.js";import{_ as rt}from"./LayoutBoards.vue.1keADq5t.js";import{_ as lt}from"./StatusRibbon.BLB8aOUn.js";import{_ as it}from"./IsoHeader.vue.CeUOAvDJ.js";import{_ as ct}from"./FormSignatory.clwn2CYc.js";import{_ as dt}from"./SignaturesRow.C1wR1gOd.js";import{b as pt,c as ut,a as q,f as O,d as mt}from"./Utilities.Cbr1Z9cn.js";import{f as _t,C as S,o as r,c as p,F as U,i as V,b as u,u as a,j as T,a as t,t as o,h as D,w as R,p as yt,e as gt,_ as ft,q as Z,d as L,l as ht,n as bt,r as M,s as z,B as xt,L as vt,v as B,K as wt}from"./entry.R6V7NTxy.js";import{_ as Rt}from"./LayoutPrint.Dr_MMYe1.js";import{_ as kt}from"./ApprovalDenyButton.B1ShEyLo.js";import At from"./Icon.DcF_NU9d.js";import{_ as Lt}from"./PsModal.DW9SixU3.js";import{a as qt,u as Ct,A as $t}from"./Accessibilities.uaboihcy.js";import{u as N}from"./CustomFetch.BRBLzGci.js";import{_ as Tt}from"./AcessContainer.DJcSsti6.js";import"./id.Dwf9xs1O.js";import"./client-only.QuN6N-R_.js";import"./nuxt-link.drPfi767.js";import"./loader.C2wIXBoB.js";import"./evenpar.D2HxGWpc.js";import"./index.T-zbMaZc.js";import"./users.D5_vMoUK.js";const k=e=>(yt("data-v-d07d2f4c"),e=e(),gt(),e),Pt={id:"toPrint",class:"flex flex-col gap-2 bg-white left-0 top-0 w-screen max-w-[100%] p-2"},Dt={key:0,id:"headText",class:"text-2xl text-center font-bold text-block border-b-2 pb-2 border-black"},Mt={key:1,class:"flex flex-col gap-2 !text-xs pt-12"},Et={class:"border border-black"},It=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," PAYEE : ",-1)),Ft={class:"border border-black pl-2 py-1 text-xs"},St=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," ENCODED DATE : ",-1)),Ut={class:"border border-black pl-2 py-1 text-xs"},Ot=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," PARTICULARS : ",-1)),Nt={class:"border border-black pl-2 py-1 text-xs"},Vt=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," ENTRY DATE : ",-1)),Bt={class:"border border-black pl-2 py-1 text-xs"},jt=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," AMOUNT IN WORDS : ",-1)),Yt={class:"border border-black pl-2 py-1 text-xs"},Ht=k(()=>t("td",{class:"border border-black pl-2 py-1 text-xs bg-blue-300"}," NET AMOUNT ",-1)),Gt={class:"border border-black pl-2 py-1 text-xs"},Wt={class:"flex flex-col gap-4 h-full pt-12"},Qt={class:"flex flex-col"},Jt={class:"flex-1 mb-16"},Kt={key:0,class:"w-full border-collapse"},Xt=k(()=>t("thead",null,[t("tr",null,[t("th",{class:"border-2 border-gray-800 text-sm"}," PARTICULARS "),t("th",{class:"border-2 border-gray-800 text-sm w-1/3"}," PROJECT/SECTION CODE "),t("th",{class:"border-2 border-gray-800 text-sm"}," COST "),t("th",{class:"border-2 border-gray-800 text-sm w-24"}," VAT "),t("th",{class:"border-2 border-black border-b-gray-800 text-sm w-24"}," TOTAL ")])],-1)),Zt={class:"border px-4 py-1 border-gray-800 text-sm relative"},zt={class:"border px-4 py-1 border-gray-800 text-sm"},te={class:"border px-4 py-1 border-gray-800 text-sm"},ee={class:"border px-4 py-1 border-gray-800 text-sm"},se={class:"border px-4 py-1 border-gray-800 border-y-gray-800 text-sm"},ae={key:0,class:"border border-black"},oe=k(()=>t("td",null,null,-1)),ne=k(()=>t("td",{class:"text-center border border-black py-2"}," TOTAL ",-1)),re={class:"border border-black py-2 px-4"},le={class:"border border-black py-2 px-4"},ie={class:"border border-black py-2 px-4"},ce={key:1,class:"block text-center text-gray-600"},de=_t({__name:"PrintView",props:{data:{type:Object,default:null}},setup(e){const i=e,l=S(()=>i.data.details),d=S(()=>{let s=0;return l.value.forEach(c=>{s+=parseFloat(c==null?void 0:c.cost)}),s}),_=S(()=>{let s=0;return l.value.forEach(c=>{s+=parseFloat(c==null?void 0:c.total_vat_amount)}),s}),y=S(()=>x(l.value,15,23));function x(s,c,b){if(!s.length||c<=0||b<=0)return[];const f=[];if(c>=s.length)return[s];f.push(s.slice(0,c));for(let n=c;n<s.length;n+=b)f.push(s.slice(n,n+b));return f}return(s,c)=>{const b=it,f=ct,n=dt;return r(),p("div",Pt,[(r(!0),p(U,null,V(a(y),(h,v)=>{var C,$,A,E,I,w;return r(),p("div",{key:v,class:"flex flex-col gap-2 pt-8 relative border-2 border-black pb-4 min-h-[1000px]"},[u(b,{page:{currentPage:v+1,totalPages:a(y).length},class:"pb-4 border-b-4 border-green-400 mb-8"},null,8,["page"]),v===0?(r(),p("h1",Dt," PAYROLL VOUCHER ")):T("",!0),v===0?(r(),p("div",Mt,[t("table",Et,[t("tbody",null,[t("tr",null,[It,t("td",Ft,o(($=(C=e.data)==null?void 0:C.stakeholder)==null?void 0:$.name),1),St,t("td",Ut,o((A=e.data)==null?void 0:A.date_filed),1)]),t("tr",null,[Ot,t("td",Nt,o(e.data.description),1),Vt,t("td",Bt,o(("useFullDateTime"in s?s.useFullDateTime:a(pt))(new Date((E=e.data)==null?void 0:E.request_date))),1)]),t("tr",null,[jt,t("td",Yt,o(("amountToWords"in s?s.amountToWords:a(ut))((I=e.data)==null?void 0:I.total)),1),Ht,t("td",Gt,o(("accountingCurrency"in s?s.accountingCurrency:a(q))((w=e.data)==null?void 0:w.total)),1)])])])])):T("",!0),t("div",Wt,[t("div",Qt,[t("div",Jt,[i.data.details.length>0?(r(),p("table",Kt,[Xt,t("tbody",null,[(r(!0),p(U,null,V(h,(g,F)=>{var P;return r(),p("tr",{key:F,class:"hover:bg-gray-100 cursor-pointer"},[t("td",Zt,o(g.particulars),1),t("td",zt,o((P=g.stakeholder)==null?void 0:P.name),1),t("td",te,o(g.cost>0?("formatToCurrency"in s?s.formatToCurrency:a(O))(g.cost):"-"),1),t("td",ee,o(g.total_vat_amount>0?("formatToCurrency"in s?s.formatToCurrency:a(O))(g.total_vat_amount):"-"),1),t("td",se,o(g.amount>0?("formatToCurrency"in s?s.formatToCurrency:a(O))(g.amount):"-"),1)])}),128)),v===a(y).length-1?(r(),p("tr",ae,[oe,ne,t("td",re,o(("accountingCurrency"in s?s.accountingCurrency:a(q))(a(d))),1),t("td",le,o(("accountingCurrency"in s?s.accountingCurrency:a(q))(a(_))),1),t("td",ie,o(("accountingCurrency"in s?s.accountingCurrency:a(q))(parseFloat(i.data.total))),1)])):T("",!0)])])):T("",!0),i.data.details.length===0?(r(),p("span",ce," No entries yet. ")):T("",!0)]),v===a(y).length-1?(r(),D(n,{key:0},{default:R(()=>[u(f,{label:"REQUESTED BY",signatory:{name:i.data.created_by_user,title:""}},null,8,["signatory"]),u(f,{label:"APPROVED BY",signatories:[{name:"RICHE C. DALAUTA",title:"Director"},{name:"ANGEL A. ABRAU",title:"President"}]},null,8,["signatories"]),u(f,{label:"RECEIVED BY",signatory:{name:"",title:""}})]),_:1})):T("",!0)])])])}),128))])}}}),pe=ft(de,[["__scopeId","data-v-d07d2f4c"]]),ue={class:"flex gap-2 justify-end w-full p-8"},me={__name:"PrintPreview",props:{printPreview:{required:!1,type:Boolean}},emits:["update:printPreview"],setup(e){const i=Z(e,"printPreview");return(l,d)=>{const _=At;return r(),p("div",ue,[i.value?(r(),p("button",{key:1,class:"flex items-center gap-1 justify-center bg-orange-600 p-2 hover:bg-orange-900 text-white rounded-md w-32 text-sm",onClick:d[1]||(d[1]=y=>i.value=!1)},[u(_,{name:"iconoir:printing-page"}),L(" Hide Preview ")])):(r(),p("button",{key:0,class:"flex items-center gap-1 justify-center bg-gray-600 p-2 hover:bg-gray-900 text-white rounded-md w-32 text-sm",onClick:d[0]||(d[0]=y=>i.value=!0)},[u(_,{name:"iconoir:printing-page"}),L(" Print Preview ")]))])}}},j=ht("payrollRequestStore",{state:()=>({payrollAllRequestList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},payrollMyRequestList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""},payrollApprovalRequestList:{isLoading:!1,isLoaded:!1,list:[],params:{},pagination:{},errorMessage:"",successMessage:""}}),getters:{},actions:{async getAllRequests(){this.payrollAllRequestList.isLoaded=!0,await N("/api/payroll/resource",{method:"GET",params:this.payrollAllRequestList.params,onRequest:()=>{this.payrollAllRequestList.isLoading=!0},onResponse:({response:e})=>{this.payrollAllRequestList.isLoading=!1,e.ok&&(this.payrollAllRequestList.list=e._data.data.data,this.payrollAllRequestList.pagination={first_page:e._data.data.links.first,pages:e._data.data.meta.links,last_page:e._data.data.links.last})}})},async getMyRequests(){this.payrollMyRequestList.isLoaded=!0,await N("/api/payroll/my-requests",{method:"GET",params:this.payrollMyRequestList.params,onRequest:()=>{this.payrollMyRequestList.isLoading=!0},onResponse:({response:e})=>{this.payrollMyRequestList.isLoading=!1,e.ok&&(this.payrollMyRequestList.list=e._data.data.data,this.payrollMyRequestList.pagination={first_page:e._data.data.links.first,pages:e._data.data.meta.links,last_page:e._data.data.links.last})}})},async getMyApprovals(){this.payrollApprovalRequestList.isLoaded=!0,await N("/api/payroll/my-approvals",{method:"GET",params:this.payrollApprovalRequestList.params,onRequest:()=>{this.payrollApprovalRequestList.isLoading=!0},onResponse:({response:e})=>{this.payrollApprovalRequestList.isLoading=!1,e.ok&&(this.payrollApprovalRequestList.list=e._data.data.data,this.payrollApprovalRequestList.pagination={first_page:e._data.data.links.first,pages:e._data.data.meta.links,last_page:e._data.data.links.last})}})},reloadResources(){const e=[];this.payrollAllRequestList.isLoaded&&e.push(this.getAllRequests),this.payrollMyRequestList.isLoaded&&e.push(this.getMyRequests),this.payrollApprovalRequestList.isLoaded&&e.push(this.getMyApprovals),this.$reset(),e.forEach(i=>{i()})}}}),_e={key:0,class:"px-4"},ye=t("div",{class:"p-2 py-4 flex gap-2 w-full mb-4"},[t("span",{class:"text-gray-900 text-4xl text-center w-full block flex-1"},"Payroll Request Form")],-1),ge={class:"grid md:grid-cols-3 gap-2 md:justify-between"},fe={class:"p-2 flex gap-2"},he=t("span",{class:"text-teal-600 text-light"},"PRF Number: ",-1),be={class:"text-gray-900"},xe={class:"p-2 flex gap-2"},ve=t("span",{class:"text-teal-600 text-light"},"Payee: ",-1),we={class:"p-2 flex gap-2"},Re=t("span",{class:"text-teal-600 text-light"},"Amount: ",-1),ke={class:"grid md:grid-cols-3 gap-2 md:justify-between"},Ae={class:"p-2 flex gap-2"},Le=t("span",{class:"text-teal-600 text-light"},"Prepared by: ",-1),qe={class:"p-2 flex gap-2"},Ce=t("span",{class:"text-teal-600 text-light"},"Prepared on: ",-1),$e={class:"p-2 flex gap-2"},Te=t("span",{class:"text-teal-600 text-light"},"Status: ",-1),Pe={class:"grid md:grid-cols-1 gap-2 md:justify-between"},De=t("div",{class:"p-2 flex gap-2"},[t("span",{class:"text-teal-600 text-light"},"Description/Remarks: ")],-1),Me={class:"p-2 flex gap-2"},Ee={class:"p-2 border border-gray-200 rounded-lg"},Ie=t("h2",{class:"text-xl text-gray-800 tex-center font-bold p-2"}," Payment Request Details ",-1),Fe={class:"overflow-x-auto"},Se={class:"min-w-full overflow-hidden overflow-x-auto align-middle shadow sm:rounded-lg"},Ue={class:"min-w-full divide-y border border-gray-200"},Oe=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-950 uppercase tracking-wider"}," Description "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-950 uppercase tracking-wider"}," Project/Section Code "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-950 uppercase tracking-wider"}," Cost "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-950 uppercase tracking-wider"}," Total Vat "),t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-950 uppercase tracking-wider"}," Total Amount ")])],-1),Ne={class:"bg-white divide-y divide-gray-200"},Ve={class:"px-6 py-4 whitespace-nowrap"},Be={class:"text-sm text-gray-600"},je={class:"px-6 py-4 whitespace-nowrap"},Ye={class:"text-sm text-gray-600"},He={class:"px-6 py-4 whitespace-nowrap"},Ge={class:"text-sm text-gray-600"},We={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"text-sm text-gray-600"},Je={class:"px-6 py-4 whitespace-nowrap"},Ke={class:"text-sm text-gray-600"},Xe={key:0,class:"flex gap-2 p-2 justify-end relative"},Ze={__name:"InfoModal",props:bt({paymentData:{type:Object,required:!1,default:null},fillable:{type:Boolean,required:!1,default:!1}},{showModal:{required:!1,type:Boolean}}),emits:["update:showModal"],setup(e){const i=Z(e,"showModal"),l=M(!1),d=j(),{remarks:_}=z(d),y=xt(),x=M(!1),s=()=>{i.value=!1},c=async n=>{try{x.value=!0,await d.approveApprovalForm(n),y.add({type:"success",text:d.successMessage}),s()}catch(h){y.add({type:"error",text:h||"something went wrong."})}finally{x.value=!1}},b=M({pending:"warning",approved:"success",denied:"error"}),f=async n=>{try{x.value=!0,await d.denyApprovalForm(n),y.add({type:"success",text:d.successMessage}),s()}catch(h){y.add({type:"error",text:h||"something went wrong."})}finally{x.value=!1}};return vt(i,n=>{n||(l.value=!1)}),(n,h)=>{const v=lt,C=pe,$=Rt,A=kt,E=me,I=Lt;return r(),D(I,{"show-modal":i.value,"onUpdate:showModal":h[2]||(h[2]=w=>i.value=w),"is-loading":a(x),title:""},{body:R(()=>{var w,g,F,P,Y,H,G,W,Q,J,K;return[u(v,{type:a(b)[(w=e.paymentData)==null?void 0:w.request_status.toLowerCase()],position:"top-left",status:(g=e.paymentData)==null?void 0:g.request_status,class:"z-30"},null,8,["type","status"]),a(l)?(r(),D($,{key:1},{default:R(()=>[u(C,{data:e.paymentData},null,8,["data"])]),_:1})):(r(),p("div",_e,[ye,t("div",ge,[t("div",fe,[he,t("span",be,o((F=e.paymentData)==null?void 0:F.prf_no),1)]),t("div",xe,[ve,L(" "+o((Y=(P=e.paymentData)==null?void 0:P.stakeholder)==null?void 0:Y.name),1)]),t("div",we,[Re,L(" "+o(("useFormatCurrency"in n?n.useFormatCurrency:a(mt))((H=e.paymentData)==null?void 0:H.total)),1)])]),t("div",ke,[t("div",Ae,[Le,L(" "+o((G=e.paymentData)==null?void 0:G.created_by_user),1)]),t("div",qe,[Ce,L(" "+o((W=e.paymentData)==null?void 0:W.date_filed),1)]),t("div",$e,[Te,L(" "+o((Q=e.paymentData)==null?void 0:Q.request_status),1)])]),t("div",Pe,[De,t("div",Me,[t("p",null,o((J=e.paymentData)==null?void 0:J.description),1)])]),t("div",Ee,[Ie,t("div",Fe,[t("div",Se,[t("table",Ue,[Oe,t("tbody",Ne,[(r(!0),p(U,null,V((K=e.paymentData)==null?void 0:K.details,m=>{var X;return r(),p("tr",{key:m.id},[t("td",Ve,[t("div",Be,o((m==null?void 0:m.particulars)??""),1)]),t("td",je,[t("div",Ye,o(((X=m==null?void 0:m.stakeholder)==null?void 0:X.name)??""),1)]),t("td",He,[t("div",Ge,o(("accountingCurrency"in n?n.accountingCurrency:a(q))(m==null?void 0:m.cost)),1)]),t("td",We,[t("div",Qe,o(("accountingCurrency"in n?n.accountingCurrency:a(q))(m==null?void 0:m.total_vat_amount)),1)]),t("td",Je,[t("div",Ke,o(("accountingCurrency"in n?n.accountingCurrency:a(q))(m==null?void 0:m.amount)),1)])])}),128))])])])])])]))]}),footer:R(()=>{var w;return[e.paymentData.next_approval&&("useCheckIsCurrentUser"in n?n.useCheckIsCurrentUser:a(qt))((w=e.paymentData.next_approval)==null?void 0:w.user_id)?(r(),p("div",Xe,[u(A,{"deny-remarks":a(_),"onUpdate:denyRemarks":h[0]||(h[0]=g=>B(_)?_.value=g:null),"request-id":e.paymentData.id,onApprove:c,onDeny:f},null,8,["deny-remarks","request-id"])])):(r(),D(E,{key:1,"print-preview":a(l),"onUpdate:printPreview":h[1]||(h[1]=g=>B(l)?l.value=g:null)},null,8,["print-preview"]))]}),_:1},8,["show-modal","is-loading"])}}},ze={class:"w-1/3 flex"},ts={class:"pb-2 text-gray-500 text-[12px] overflow-y-auto p-2"},es={class:"flex justify-center mx-auto"},ss={__name:"AllList",setup(e){const i=j(),{payrollAllRequestList:l}=z(i),d=M(null),_=M(!1),y=b=>{d.value=b,_.value=!0},x=b=>{l.value.params.page=b.page??""},s=[{name:"Payroll number",id:"prf_no"},{name:"Payee",id:"stakeholder.name"},{name:"Amount",id:"total_amount_formatted"},{name:"Date filed",id:"date_filed"},{name:"Status",id:"request_status"}],c={showTable:!0};return(b,f)=>{const n=at,h=ot,v=nt,C=rt,$=Ze;return r(),p(U,null,[t("div",ze,[u(n,{modelValue:a(l).params.key,"onUpdate:modelValue":f[0]||(f[0]=A=>a(l).params.key=A),title:"Payroll No. / Payee",class:"w-full"},null,8,["modelValue"])]),u(C,{class:"w-full",loading:a(l).isLoading},{default:R(()=>[t("div",ts,[u(h,{"header-columns":s,actions:c,datas:a(l).list??[],onShowTable:y},null,8,["datas"]),t("div",es,[u(v,{links:a(l).pagination,onChangeParams:x},null,8,["links"])])])]),_:1},8,["loading"]),u($,{showModal:a(_),"onUpdate:showModal":f[1]||(f[1]=A=>B(_)?_.value=A:null),fillable:!1,"payment-data":a(d)},null,8,["showModal","payment-data"])],64)}}},as={class:"flex flex-col gap-4"},os=t("div",null,[t("p",{class:"text-xl font-semibold"}," Payment Request Form (Payroll) ")],-1),Ts={__name:"payroll-request",setup(e){const i=j();return wt(()=>{i.getAllRequests()}),(l,d)=>{const _=tt,y=ss,x=et,s=st,c=Tt;return r(),D(c,{"if-access":("useCheckAccessibility"in l?l.useCheckAccessibility:a(Ct))([("AccessibilityTypes"in l?l.AccessibilityTypes:a($t)).ACCOUNTING_REQUEST_PRE_PAYROLL_AUDIT])},{default:R(()=>[t("div",as,[os,u(s,{class:"w-full"},{"tab-titles":R(()=>[u(_,{title:"All List","target-id":"allList",onClickOnce:d[0]||(d[0]=b=>a(i).getAllRequests())})]),"tab-containers":R(()=>[u(x,{id:"allList"},{default:R(()=>[u(y)]),_:1})]),_:1})])]),_:1},8,["if-access"])}}};export{Ts as default};
