import{_ as U}from"./LoadScreen.nbfquDjl.js";import j from"./Icon.DcF_NU9d.js";import{_ as C}from"./ModalContainer.CDqF-arx.js";import{ab as E,l as L,O as S,f as I,r as q,B as N,o as m,h as V,w as O,a as i,b as w,u as r,t as x,g as z,x as u,A as g,c as v,j as R,L as T,F as H,i as K,D as Q}from"./entry.R6V7NTxy.js";import{e as B}from"./Utilities.Cbr1Z9cn.js";import{u as G}from"./projects.BzIGGuNp.js";import{h as p,d}from"./CustomFetch.BRBLzGci.js";const Z=S(),{token:W}=E(),J=L("phaseStore",{state:()=>({phase:{id:null,project_id:null,name:null,description:null,total_cost:null},list:[],pagination:{},getParams:{},errorMessage:"",successMessage:"",isLoading:{list:!1,create:!1,delete:!1},isEdit:!1}),actions:{async getPhases(e){this.isLoading.list=!0;const{data:s,error:t}=await p("/api/phases?project_id="+e,{baseURL:Z.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:W.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:a})=>{this.isLoading.list=!1,this.list=a._data.data,this.pagination={first_page:a._data.links.first,pages:a._data.meta.links,last_page:a._data.links.last}}},"$j4dsUgfRR0");if(s)return s;if(t)return t},async createPhase(){this.successMessage="",this.errorMessage="",await d("/api/phases",{method:"POST",body:this.phase,watch:!1,onResponse:({response:e})=>{e.ok?(this.phase=e._data.data,this.successMessage=e._data.message):this.errorMessage=e._data.message}})},async editPhase(){this.successMessage="",this.errorMessage="";const{data:e,error:s}=await d("/api/phases/"+this.phase.id,{method:"PATCH",body:this.phase,watch:!1});if(e.value)return this.getPhases(this.phase.project_id),this.successMessage=e.value.message,e;if(s.value)return this.errorMessage=s.value.data.message,s},async deletePhase(e){const{data:s,error:t}=await d("/api/phases/"+e,{method:"DELETE",body:this.phase,watch:!1,onResponse:({response:a})=>{this.successMessage=a._data.message}});if(s.value)return this.successMessage=s.value.message,s;if(t.value)return this.errorMessage=t.value.data.message,t},reset(){this.phase={id:null,project_id:null,name:null,description:null,total_cost:null},this.successMessage="",this.errorMessage=""}}}),Y={class:"flex flex-col p-4"},X={class:"flex items-center justify-between mb-8"},ee={class:"flex flex-col items-start gap-2"},se={class:"text-2xl font-bold uppercase text-center"},te=i("h3",{class:"text-gray-400 text-xs"}," Fill out the details below to create a new part. Provide a clear name and a short description for identification. ",-1),ae={class:"grid grid-cols-2 gap-4 mb-4"},ie={class:"flex flex-col"},oe=i("label",{class:"text-md text-gray-700 mb-2"}," Part No * ",-1),re={class:"flex flex-col mb-6"},ne=i("label",{class:"text-md text-gray-700 mb-2"}," Description * ",-1),le={class:"flex justify-end"},de={key:0,class:"bg-green-500 hover:bg-green-600 active:bg-green-700 select-none text-white rounded-lg text-sm w-36 h-10",type:"submit"},ce={key:1,class:"bg-green-500 hover:bg-green-600 active:bg-green-700 select-none text-white rounded-lg text-sm w-36 h-10",type:"submit"},Ze=I({__name:"ModalsPhase",props:{showModal:{type:Boolean,required:!0,default:!1},isEdit:{type:Boolean,required:!1,default:!1}},emits:["hideModal","save"],setup(e,{emit:s}){const t=J(),a=G(),f=q(!1),_=N(),b=async h=>{try{f.value=!0,h?await t.editPhase():await t.createPhase(),t.errorMessage!==""?_.add({type:"error",text:t.errorMessage}):(h||(a.information.phases.push(B(t.phase)),s("save",t.phase)),_.add({type:"success",text:t.successMessage}))}catch{_.add({type:"error",text:t.errorMessage})}finally{t.phase.project_id=a.information.id,f.value=!1,s("hideModal")}};return(h,l)=>{const P=U,y=j,o=C;return m(),V(o,{show:e.showModal,local:!0,header:!1,bg:"bg-gray-50",size:"modal-lg",onHide:l[4]||(l[4]=c=>s("hideModal"))},{default:O(()=>[i("div",Y,[w(P,{"is-loading":r(f)},null,8,["is-loading"]),i("div",X,[i("div",ee,[i("h1",se,x(e.isEdit?"Edit Part":"Create Part"),1),te]),w(y,{name:"material-symbols:close-rounded",class:"h-6 w-6 text-gray-500 hover:text-gray-800 cursor-pointer",onClick:l[0]||(l[0]=c=>s("hideModal"))})]),i("form",{onSubmit:l[3]||(l[3]=z(c=>b(e.isEdit),["prevent"]))},[i("div",ae,[i("div",ie,[oe,u(i("input",{"onUpdate:modelValue":l[1]||(l[1]=c=>r(t).phase.name=c),type:"text",class:"border border-gray-300 rounded-md"},null,512),[[g,r(t).phase.name]])])]),i("div",re,[ne,u(i("textarea",{"onUpdate:modelValue":l[2]||(l[2]=c=>r(t).phase.description=c),class:"border border-gray-300 rounded-md w-full h-56 resize-none"},null,512),[[g,r(t).phase.description]])]),i("div",le,[e.isEdit?R("",!0):(m(),v("button",de," Save Part ")),e.isEdit?(m(),v("button",ce," Update Part ")):R("",!0)])],32)])]),_:1},8,["show"])}}}),A=S(),{token:$}=E(),ue=L("taskStore",{state:()=>({task:{id:null,project_id:null,phase_id:null,name:null,description:null,quantity:null,unit:null,unit_price:null,amount:null,unit_price_with_unit:null},list:[],pagination:{},getParams:{},errorMessage:"",successMessage:"",isLoading:{list:!1,create:!1,delete:!1},isEdit:!1}),actions:{async getTasks(e){this.isLoading.list=!0;const{data:s,error:t}=await p("/api/tasks/"+e,{baseURL:A.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:$.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:a})=>{this.isLoading.list=!1,this.list=a._data.data,this.pagination={first_page:a._data.links.first,pages:a._data.meta.links,last_page:a._data.links.last}}},"$6K2V9deaSJ");if(s)return s;if(t)return t},async getTask(e){this.isLoading.list=!0;const{data:s,error:t}=await p("/api/tasks/"+e,{baseURL:A.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:$.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:a})=>{this.isLoading.list=!1,this.task=a._data.data}},"$9nZTTfAlZ5");if(s)return s;if(t)return t},async createTask(){this.successMessage="",this.errorMessage="",await d("/api/tasks",{method:"POST",body:this.task,watch:!1,onResponse:({response:e})=>{e.ok?(this.task=e._data.data,this.successMessage=e._data.message):this.errorMessage=e._data.message}})},async editTask(){this.successMessage="",this.errorMessage="";const{data:e,error:s}=await d("/api/tasks/"+this.task.id,{method:"PATCH",body:this.task,watch:!1});if(e.value)return this.getTasks(this.task.phase_id),this.successMessage=e.value.message,e;if(s.value)return this.errorMessage=s.value.data.message,s},async deleteTask(e){const{data:s,error:t}=await d("/api/tasks/"+e,{method:"DELETE",body:this.task,watch:!1,onResponse:({response:a})=>{this.successMessage=a._data.message}});if(s.value)return this.getTasks(this.task.phase_id),this.successMessage=s.value.message,s;if(t.value)return this.errorMessage="Error",t},reset(){this.task={id:null,project_id:null,phase_id:null,name:null,description:null,quantity:null,unit:null,unit_price:null,amount:null},this.successMessage="",this.errorMessage=""}}}),k=S(),{token:M}=E(),he="Materials",ge="Equipment",me="Labor",We=[he,me,ge],pe=L("resourceStore",{state:()=>({resource:{id:null,task_id:1,name_id:1,description:null,quantity:null,unit:"",unit_cost:null,resource_count:0,unit_count:1},resourceNames:[],units:[],list:[],pagination:{},getParams:{},errorMessage:"",successMessage:"",isLoading:{list:!1,create:!1},isEdit:!1}),actions:{async getResources(){this.isLoading.list=!0;const{data:e,error:s}=await p("/api/resource-items",{baseURL:k.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:M.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:t})=>{this.isLoading.list=!1,this.list=t._data.data,this.pagination={first_page:t._data.links.first,pages:t._data.meta.links,last_page:t._data.links.last}}},"$VAnSvPB4WI");if(e)return e;if(s)return s},async getResourceNames(){this.isLoading.list=!0;const{data:e,error:s}=await p("/api/lookups/resource-names",{baseURL:k.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:M.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:t})=>{this.isLoading.list=!1,this.resourceNames=t._data,this.pagination={first_page:t._data.links.first,pages:t._data.meta.links,last_page:t._data.links.last}}},"$IgoySYVLZz");if(e)return e;if(s)return s},async getResourceUnits(){this.isLoading.list=!0;const{data:e,error:s}=await p("/api/lookups/uom",{baseURL:k.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:M.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:t})=>{this.isLoading.list=!1,this.units=t._data}},"$GkcmfJFa2q");if(e)return e;if(s)return s},async getResource(e){this.isLoading.list=!0;const{data:s,error:t}=await p("/api/resource-items/"+e,{baseURL:k.public.PROJECTS_API_URL,method:"GET",headers:{Authorization:M.value+"",Accept:"application/json"},params:this.getParams,onResponse:({response:a})=>{this.isLoading.list=!1,this.resource=a._data.data}},"$IvEKQo7NB7");if(s)return s;if(t)return t},async createResource(){this.successMessage="",this.errorMessage="",await d("/api/resource-items",{method:"POST",body:this.resource,watch:!1,onResponse:({response:e})=>{e.ok?(this.getResources(),this.reset(),this.successMessage=e._data.message):this.errorMessage=e._data.message}})},async editResource(){this.successMessage="",this.errorMessage="";const{data:e,error:s}=await d("/api/resource-items/"+this.resource.id,{method:"PATCH",body:this.resource,watch:!1});if(e.value)return this.getResources(this.resource.project_id),this.successMessage=e.value.message,e;if(s.value)return this.errorMessage=s.value.data.message,s},async deleteResource(e){const{data:s,error:t}=await d("/api/resource-items/"+e,{method:"DELETE",body:this.resource,watch:!1,onResponse:({response:a})=>{this.successMessage=a._data.message}});if(s.value)return this.successMessage=s.value.message,s;if(t.value)return this.errorMessage=t.value.data.message,t},reset(){this.resource={id:null,task_id:1,name_id:null,description:null,quantity:null,unit:"",unit_cost:null,resource_count:0},this.successMessage="",this.errorMessage=""}}}),_e={class:"flex flex-col p-4"},fe={class:"flex items-center justify-between mb-4"},be={class:"flex items-end gap-2"},ye={class:"text-2xl uppercase"},xe={class:"flex gap-4 items-center"},ve=i("label",{class:"text-sm text-gray-700 uppercase text-md"}," Part Name: ",-1),ke={class:"text-green-600 text-lg"},Me=i("div",{class:"mb-10"},[i("p",{class:"text-xs text-gray-400"}," Fill out the details below to create a new part. Provide a clear name and a short description for identification. ")],-1),we={class:"grid grid-cols-2 gap-6 mb-4"},Pe={class:"flex flex-col"},Re=i("label",{class:"text-sm text-gray-700 mb-2"}," Item Name * ",-1),Ee={class:"flex flex-col"},Le=i("label",{class:"text-sm mb-1 text-gray-700"}," Amount ",-1),Se={class:"grid grid-cols-2 gap-6 mb-4"},Te={class:"flex flex-col"},Ae=i("label",{class:"text-sm mb-1 text-gray-700"}," Quantity * ",-1),$e={class:"flex flex-col"},Ue=i("label",{class:"text-sm mb-1 text-gray-700"}," Unit * ",-1),je=i("option",{value:"",disabled:"",selected:""}," Select Unit ",-1),Ce=["value"],Ie={class:"grid grid-cols-2 gap-6 mb-4"},qe={class:"flex flex-col"},Ne=i("label",{class:"text-sm mb-1 text-gray-700"}," Unit Price * ",-1),Ve={class:"flex flex-col mb-4"},Oe=i("label",{class:"text-sm mb-1 text-gray-700"}," Description * ",-1),ze={class:"flex justify-end"},Be={key:0,class:"bg-green-500 hover:bg-green-600 active:bg-green-700 select-none text-white rounded-lg text-sm w-36 h-10",type:"submit"},Ye=I({__name:"ModalsTask",props:{showModal:{type:Boolean,required:!0,default:!1},isEdit:{type:Boolean,required:!1,default:!1}},emits:["hideModal","save"],setup(e,{emit:s}){const t=pe(),a=ue(),f=J(),_=G(),b=q(!1),h=N(),l=()=>{a.task.amount=Number(a.task.quantity)*Number(a.task.unit_price)};T(()=>a.task.quantity,l),T(()=>a.task.unit_price,l);const P=async y=>{try{b.value=!0,y?await a.editTask():await a.createTask(),a.errorMessage!==""?h.add({type:"error",text:a.errorMessage}):(y||s("save",B(a.task)),h.add({type:"success",text:a.successMessage}))}catch{h.add({type:"error",text:a.errorMessage})}finally{b.value=!1,s("hideModal"),_.getProject(_.information.id)}};return(y,o)=>{const c=U,D=j,F=C;return m(),V(F,{show:e.showModal,local:!0,header:!1,bg:"bg-gray-50",size:"modal-lg",onHide:o[8]||(o[8]=n=>s("hideModal"))},{default:O(()=>[i("div",_e,[w(c,{"is-loading":r(b)},null,8,["is-loading"]),i("div",fe,[i("div",be,[i("h1",ye,x(e.isEdit?"Edit Item":"Create Item"),1)]),w(D,{name:"material-symbols:close-rounded",class:"h-6 w-6 text-gray-500 hover:text-gray-800 cursor-pointer",onClick:o[0]||(o[0]=n=>s("hideModal"))})]),i("div",xe,[ve,i("h3",ke,x(r(f).phase.name),1)]),Me,i("form",{onSubmit:o[7]||(o[7]=z(n=>P(e.isEdit),["prevent"]))},[i("div",we,[i("div",Pe,[Re,u(i("input",{"onUpdate:modelValue":o[1]||(o[1]=n=>r(a).task.name=n),type:"text",class:"border border-gray-300 rounded-md",placeholder:"Item Name",required:""},null,512),[[g,r(a).task.name]])]),i("div",Ee,[Le,u(i("input",{"onUpdate:modelValue":o[2]||(o[2]=n=>r(a).task.amount=n),type:"text",class:"border border-gray-300 rounded-md",disabled:"",placeholder:"0.00",required:""},null,512),[[g,r(a).task.amount]])])]),i("div",Se,[i("div",Te,[Ae,u(i("input",{"onUpdate:modelValue":o[3]||(o[3]=n=>r(a).task.quantity=n),type:"number",step:"any",class:"border border-gray-300 rounded-md",placeholder:"0",required:""},null,512),[[g,r(a).task.quantity]])]),i("div",$e,[Ue,u(i("select",{"onUpdate:modelValue":o[4]||(o[4]=n=>r(a).task.unit=n),class:"border border-gray-300 rounded-md uppercase",required:""},[je,(m(!0),v(H,null,K(r(t).units,n=>(m(),v("option",{key:n.name,value:n.symbol},x(n.name+" ("+n.symbol+")"),9,Ce))),128))],512),[[Q,r(a).task.unit]])])]),i("div",Ie,[i("div",qe,[Ne,u(i("input",{"onUpdate:modelValue":o[5]||(o[5]=n=>r(a).task.unit_price=n),type:"number",step:"any",class:"border border-gray-300 rounded-md",placeholder:"0.00",required:""},null,512),[[g,r(a).task.unit_price]])])]),i("div",Ve,[Oe,u(i("textarea",{"onUpdate:modelValue":o[6]||(o[6]=n=>r(a).task.description=n),class:"border border-gray-300 rounded-md w-full h-56 resize-none",required:""},null,512),[[g,r(a).task.description]])]),i("div",ze,[!r(a).task.id||e.isEdit?(m(),v("button",Be,x(e.isEdit?"Update Item":"Create Item"),1)):R("",!0)])],32)])]),_:1},8,["show"])}}});export{We as M,Ze as _,ue as a,J as b,Ye as c,pe as u};
