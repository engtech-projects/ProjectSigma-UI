import{_ as g}from"./PsSelectSearch.vue.CT-F0Leg.js";import{l as h,f as _,s as y,K as p,N as f,r as M,L as w,o as E,h as b,u as o,v}from"./entry.32UGFqj-.js";import{c as m,b as t}from"./CustomFetch.ggXvTdIz.js";import{u as k}from"./employeeSearch.AgeAeP2j.js";const P=h("employee",{state:()=>({editable:!1,spouseData:{},information:{id:null,profile_photo:{id:null,url:"",image_type:""},digital_signature:{id:null,url:"",image_type:""},employee_id:null,first_name:"",middle_name:"",family_name:"",name_suffix:"",nick_name:"",cellphone:null,land_line:null,date_of_birth:"",place_of_birth:"",date_of_marriage:"",citizenship:"",blood_type:"",gender:"",religion:"",civil_status:"",height:"",weight:"",child:[],spouse:[],father:{},mother:{},contact_person:{id:null,name:"",employee_id:null,zip:null,brgy:"",city:"",contact_no:"",date_of_birth:"",occupation:"",province:"",age:"",relationship:"",street:"",type:"",updated_at:"",created_at:"",deleted_at:""},masterstudies:[],doctorstudies:[],professionalstudies:[],employee_education_elementary:{},employee_education_secondary:{},employee_education_vocationalcourse:{},employee_education_college:{},employee_education_graduatestudies:[],employee_eligibility:[],employee_seminartraining:[],employee_internal:[],employee_externalwork:[],employee_address:[],employment_records:[],employee_affiliation:[],employee_education:[],present_address:{id:null,employee_id:null,street:null,brgy:null,city:null,zip:null,province:null,type:null},permanent_address:{id:null,employee_id:null,street:null,brgy:null,city:null,zip:null,province:null,type:null},company_employments:{id:null,employeedisplay_id:"",company:"",date_hired:"",position:"",department:"",employee_id:"",imidiate_supervisor:"",pagibig_number:"",phic_number:"",sss_number:"",tin_number:"",created_at:"",updated_at:"",deleted_at:""},employee_uploads:[],leaveCredits:[]},employeeIsSearched:!1,permanentAddressParams:{id:null,employee_id:null,street:null,brgy:null,city:null,zip:null,province:null,type:null},presentAddressParams:{id:null,employee_id:null,street:null,brgy:null,city:null,zip:null,province:null,type:null},errorMessage:"",successMessage:"",employeeList:[],filterAttendanceList:[],getParams:{}}),getters:{fullname(a){return a.information?a.information.first_name+" "+(a.information.middle_name||"")+" "+a.information.family_name+" "+(a.information.name_suffix||""):""},contactPersonAddress(a){let e="";return a.information?(a.information.contact_person&&(e=a.information.contact_person.street+" "+a.information.contact_person.brgy+" "+a.information.contact_person.city+" "+a.information.contact_person.province),e):""},presentAddressData(a){let e={};return a.information&&a.information.employee_address&&a.information.employee_address.forEach(s=>{s.type==="present"&&(e=s)}),e},permanentAddressData(a){let e={};return a.information?(a.information.employee_address&&a.information.employee_address.forEach(s=>{(s.type==="both"||s.type==="permanent")&&(e=s)}),e):""},childrenInformation(a){const e={};if(!a.information)return e;if(a.information.child)return a.information.child},spouseInformation(a){return a.information?a.information.spouse:{}},employeesList(a){return a.employeeList.map(e=>({id:e.id,employee_id:e.employee_id,first_name:e.first_name,middle_name:e.middle_name,last_name:e.last_name}))}},actions:{async getEmployeeList(){const{data:a,error:e}=await m("/api/employee/list",{method:"GET",params:this.getParams,onResponse:({response:s})=>{this.employeeList=s._data.data}});if(a)return a;if(e)return e},async uploadDoc(a){this.successMessage="",this.errorMessage="",await t("/api/employee/uploads",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async getEmployeeInformation(a){this.$reset();const{data:e,error:s}=await m("/api/employee/resource/"+a,{method:"GET",watch:!1});if(s.value)return s;if(e.value)return this.employeeIsSearched=!0,this.information=e.value.data,e},async getPublicEmployeeInformation(a){this.$reset();const{data:e,error:s}=await m("/api/employee/resource/v2/"+a,{method:"GET",watch:!1});if(s.value)return s;if(e.value)return this.employeeIsSearched=!0,this.information=e.value.data,e},async getLeaveCredits(a){await t("/api/employee/leave-credits/"+a,{method:"GET",onResponse:({response:e})=>{if(e.ok)return this.information.leaveCredits=e._data.data,this.successMessage=e._data.message,e._data.data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveRelatedPerson(a){this.successMessage="",this.errorMessage="",await t("/api/employee/relatedperson",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateRelatedPerson(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/relatedperson/"+e,{method:"PUT",body:a,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async deleteRelatedPerson(a){this.successMessage="",this.errorMessage="",await t("/api/employee/relatedperson/"+a,{method:"DELETE",onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateEmployeeInformation(a){this.successMessage="",this.errorMessage="",await t("/api/employee/resource/"+a,{method:"PUT",body:this.information,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveEmployeeAddress(a){this.successMessage="",this.errorMessage="",await t("/api/employee/address",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateEmployeeAddress(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/address/"+a,{method:"PUT",body:e,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async saveEmployeeSchool(a){this.successMessage="",this.errorMessage="",await t("/api/employee/education",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateEmployeeSchool(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/education/"+a,{method:"PUT",body:e,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async deleteEmployeeSchool(a){this.successMessage="",this.errorMessage="",await t("/api/employee/address/"+a,{method:"DELETE",body:this.permanentAddressParams,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateEmployeeCompanyInfo(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/companyemployment/"+e,{method:"PUT",body:a,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async saveEmployeeCompanyInfo(a){this.successMessage="",this.errorMessage="",await t("/api/employee/companyemployment",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveDigitalSignatureUpload(a){this.successMessage="",this.errorMessage="",await t("/api/images/upload/digital-signature/"+this.information.id,{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveEmployeeProfilePicture(a){this.successMessage="",this.errorMessage="",await t("/api/images/upload/profile-picture/"+this.information.id,{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveUpdateSeminarTraining(a){this.successMessage="",this.errorMessage="",await t("/api/employee/seminartraining",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateSeminarTraining(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/relatedperson/"+e,{method:"PUT",body:a,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async deleteSeminarTraining(a){this.successMessage="",this.errorMessage="",await t("/api/employee/seminartraining/"+a,{method:"DELETE",onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async saveUpdateExternalCareerData(a){this.successMessage="",this.errorMessage="",await t("/api/employee/seminartraining",{method:"POST",body:a,onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateExternalCareer(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/relatedperson/"+e,{method:"PUT",body:a,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})},async deleteExternalCareer(a){this.successMessage="",this.errorMessage="",await t("/api/employee/seminartraining/"+a,{method:"DELETE",onResponse:({response:e})=>{if(e.ok)return this.successMessage=e._data.message,e._data;throw this.errorMessage=e._data.message,new Error(e._data.message)}})},async updateInternalWorkExperience(a,e){this.successMessage="",this.errorMessage="",await t("/api/employee/internalwork-experience/"+e,{method:"PUT",body:a,onResponse:({response:s})=>{if(s.ok)return this.successMessage=s._data.message,s._data;throw this.errorMessage=s._data.message,new Error(s._data.message)}})}}}),I=_({__name:"search-bar",emits:["searchChanged"],setup(a,{emit:e}){const s=P(),c=k(),{employeesAll:r}=y(c);p(()=>{r.value.loadCount<=0&&c.searchEmployees(),r.value.loadCount++}),f(()=>{r.value.loadCount--});const n=M({});return w(n,async i=>{i!=null&&i.id?(await s.getEmployeeInformation(i.id),e("searchChanged",i)):s.$reset()}),(i,d)=>{const u=g;return E(),b(u,{result:o(n),"onUpdate:result":d[0]||(d[0]=l=>v(n)?n.value=l:null),"search-input":o(r).params.key,"onUpdate:searchInput":d[1]||(d[1]=l=>o(r).params.key=l),loading:o(r).isLoading,"search-list":o(r).list,title:"search_details",placeholder:"Search Employee"},null,8,["result","search-input","loading","search-list"])}}});export{I as _,P as u};
